#Practical Machine Learning- Final Project
#4-17-2016


#INSTALL LIBRARIES
library(caret)
Loading required package: lattice
Loading required package: ggplot2
Find out what's changed in ggplot2 at
http://github.com/hadley/ggplot2/releases.
Warning message:
package ‘caret’ was built under R version 3.2.5 
library(e1071)
Warning message:
package ‘e1071’ was built under R version 3.2.5 
library(rattle)
Rattle: A free graphical interface for data mining with R.
Version 4.1.0 Copyright (c) 2006-2015 Togaware Pty Ltd.
Type 'rattle()' to shake, rattle, and roll your data.
Warning message:
package ‘rattle’ was built under R version 3.2.5 
library(rpart)
library(rpart.plot)
Warning message:
package ‘rpart.plot’ was built under R version 3.2.5 
library(randomForest)
randomForest 4.6-12
Type rfNews() to see new features/changes/bug fixes.

Attaching package: ‘randomForest’

The following object is masked from ‘package:ggplot2’:

    margin

Warning message:
package ‘randomForest’ was built under R version 3.2.5 


#LOAD DATA
train=read.csv("pml-training.csv")
test=read.csv("pml-testing.csv")

dim(train)
[1] 19622   160
dim(test)
[1]  20 160
names(train)
  [1] "X"                        "user_name"               
  [3] "raw_timestamp_part_1"     "raw_timestamp_part_2"    
  [5] "cvtd_timestamp"           "new_window"              
  [7] "num_window"               "roll_belt"               
  [9] "pitch_belt"               "yaw_belt"                
 [11] "total_accel_belt"         "kurtosis_roll_belt"      
 [13] "kurtosis_picth_belt"      "kurtosis_yaw_belt"       
 [15] "skewness_roll_belt"       "skewness_roll_belt.1"    
 [17] "skewness_yaw_belt"        "max_roll_belt"           
 [19] "max_picth_belt"           "max_yaw_belt"            
 [21] "min_roll_belt"            "min_pitch_belt"          
 [23] "min_yaw_belt"             "amplitude_roll_belt"     
 [25] "amplitude_pitch_belt"     "amplitude_yaw_belt"      
 [27] "var_total_accel_belt"     "avg_roll_belt"           
 [29] "stddev_roll_belt"         "var_roll_belt"           
 [31] "avg_pitch_belt"           "stddev_pitch_belt"       
 [33] "var_pitch_belt"           "avg_yaw_belt"            
 [35] "stddev_yaw_belt"          "var_yaw_belt"            
 [37] "gyros_belt_x"             "gyros_belt_y"            
 [39] "gyros_belt_z"             "accel_belt_x"            
 [41] "accel_belt_y"             "accel_belt_z"            
 [43] "magnet_belt_x"            "magnet_belt_y"           
 [45] "magnet_belt_z"            "roll_arm"                
 [47] "pitch_arm"                "yaw_arm"                 
 [49] "total_accel_arm"          "var_accel_arm"           
 [51] "avg_roll_arm"             "stddev_roll_arm"         
 [53] "var_roll_arm"             "avg_pitch_arm"           
 [55] "stddev_pitch_arm"         "var_pitch_arm"           
 [57] "avg_yaw_arm"              "stddev_yaw_arm"          
 [59] "var_yaw_arm"              "gyros_arm_x"             
 [61] "gyros_arm_y"              "gyros_arm_z"             
 [63] "accel_arm_x"              "accel_arm_y"             
 [65] "accel_arm_z"              "magnet_arm_x"            
 [67] "magnet_arm_y"             "magnet_arm_z"            
 [69] "kurtosis_roll_arm"        "kurtosis_picth_arm"      
 [71] "kurtosis_yaw_arm"         "skewness_roll_arm"       
 [73] "skewness_pitch_arm"       "skewness_yaw_arm"        
 [75] "max_roll_arm"             "max_picth_arm"           
 [77] "max_yaw_arm"              "min_roll_arm"            
 [79] "min_pitch_arm"            "min_yaw_arm"             
 [81] "amplitude_roll_arm"       "amplitude_pitch_arm"     
 [83] "amplitude_yaw_arm"        "roll_dumbbell"           
 [85] "pitch_dumbbell"           "yaw_dumbbell"            
 [87] "kurtosis_roll_dumbbell"   "kurtosis_picth_dumbbell" 
 [89] "kurtosis_yaw_dumbbell"    "skewness_roll_dumbbell"  
 [91] "skewness_pitch_dumbbell"  "skewness_yaw_dumbbell"   
 [93] "max_roll_dumbbell"        "max_picth_dumbbell"      
 [95] "max_yaw_dumbbell"         "min_roll_dumbbell"       
 [97] "min_pitch_dumbbell"       "min_yaw_dumbbell"        
 [99] "amplitude_roll_dumbbell"  "amplitude_pitch_dumbbell"
[101] "amplitude_yaw_dumbbell"   "total_accel_dumbbell"    
[103] "var_accel_dumbbell"       "avg_roll_dumbbell"       
[105] "stddev_roll_dumbbell"     "var_roll_dumbbell"       
[107] "avg_pitch_dumbbell"       "stddev_pitch_dumbbell"   
[109] "var_pitch_dumbbell"       "avg_yaw_dumbbell"        
[111] "stddev_yaw_dumbbell"      "var_yaw_dumbbell"        
[113] "gyros_dumbbell_x"         "gyros_dumbbell_y"        
[115] "gyros_dumbbell_z"         "accel_dumbbell_x"        
[117] "accel_dumbbell_y"         "accel_dumbbell_z"        
[119] "magnet_dumbbell_x"        "magnet_dumbbell_y"       
[121] "magnet_dumbbell_z"        "roll_forearm"            
[123] "pitch_forearm"            "yaw_forearm"             
[125] "kurtosis_roll_forearm"    "kurtosis_picth_forearm"  
[127] "kurtosis_yaw_forearm"     "skewness_roll_forearm"   
[129] "skewness_pitch_forearm"   "skewness_yaw_forearm"    
[131] "max_roll_forearm"         "max_picth_forearm"       
[133] "max_yaw_forearm"          "min_roll_forearm"        
[135] "min_pitch_forearm"        "min_yaw_forearm"         
[137] "amplitude_roll_forearm"   "amplitude_pitch_forearm" 
[139] "amplitude_yaw_forearm"    "total_accel_forearm"     
[141] "var_accel_forearm"        "avg_roll_forearm"        
[143] "stddev_roll_forearm"      "var_roll_forearm"        
[145] "avg_pitch_forearm"        "stddev_pitch_forearm"    
[147] "var_pitch_forearm"        "avg_yaw_forearm"         
[149] "stddev_yaw_forearm"       "var_yaw_forearm"         
[151] "gyros_forearm_x"          "gyros_forearm_y"         
[153] "gyros_forearm_z"          "accel_forearm_x"         
[155] "accel_forearm_y"          "accel_forearm_z"         
[157] "magnet_forearm_x"         "magnet_forearm_y"        
[159] "magnet_forearm_z"         "classe"                  
names(test)
  [1] "X"                        "user_name"               
  [3] "raw_timestamp_part_1"     "raw_timestamp_part_2"    
  [5] "cvtd_timestamp"           "new_window"              
  [7] "num_window"               "roll_belt"               
  [9] "pitch_belt"               "yaw_belt"                
 [11] "total_accel_belt"         "kurtosis_roll_belt"      
 [13] "kurtosis_picth_belt"      "kurtosis_yaw_belt"       
 [15] "skewness_roll_belt"       "skewness_roll_belt.1"    
 [17] "skewness_yaw_belt"        "max_roll_belt"           
 [19] "max_picth_belt"           "max_yaw_belt"            
 [21] "min_roll_belt"            "min_pitch_belt"          
 [23] "min_yaw_belt"             "amplitude_roll_belt"     
 [25] "amplitude_pitch_belt"     "amplitude_yaw_belt"      
 [27] "var_total_accel_belt"     "avg_roll_belt"           
 [29] "stddev_roll_belt"         "var_roll_belt"           
 [31] "avg_pitch_belt"           "stddev_pitch_belt"       
 [33] "var_pitch_belt"           "avg_yaw_belt"            
 [35] "stddev_yaw_belt"          "var_yaw_belt"            
 [37] "gyros_belt_x"             "gyros_belt_y"            
 [39] "gyros_belt_z"             "accel_belt_x"            
 [41] "accel_belt_y"             "accel_belt_z"            
 [43] "magnet_belt_x"            "magnet_belt_y"           
 [45] "magnet_belt_z"            "roll_arm"                
 [47] "pitch_arm"                "yaw_arm"                 
 [49] "total_accel_arm"          "var_accel_arm"           
 [51] "avg_roll_arm"             "stddev_roll_arm"         
 [53] "var_roll_arm"             "avg_pitch_arm"           
 [55] "stddev_pitch_arm"         "var_pitch_arm"           
 [57] "avg_yaw_arm"              "stddev_yaw_arm"          
 [59] "var_yaw_arm"              "gyros_arm_x"             
 [61] "gyros_arm_y"              "gyros_arm_z"             
 [63] "accel_arm_x"              "accel_arm_y"             
 [65] "accel_arm_z"              "magnet_arm_x"            
 [67] "magnet_arm_y"             "magnet_arm_z"            
 [69] "kurtosis_roll_arm"        "kurtosis_picth_arm"      
 [71] "kurtosis_yaw_arm"         "skewness_roll_arm"       
 [73] "skewness_pitch_arm"       "skewness_yaw_arm"        
 [75] "max_roll_arm"             "max_picth_arm"           
 [77] "max_yaw_arm"              "min_roll_arm"            
 [79] "min_pitch_arm"            "min_yaw_arm"             
 [81] "amplitude_roll_arm"       "amplitude_pitch_arm"     
 [83] "amplitude_yaw_arm"        "roll_dumbbell"           
 [85] "pitch_dumbbell"           "yaw_dumbbell"            
 [87] "kurtosis_roll_dumbbell"   "kurtosis_picth_dumbbell" 
 [89] "kurtosis_yaw_dumbbell"    "skewness_roll_dumbbell"  
 [91] "skewness_pitch_dumbbell"  "skewness_yaw_dumbbell"   
 [93] "max_roll_dumbbell"        "max_picth_dumbbell"      
 [95] "max_yaw_dumbbell"         "min_roll_dumbbell"       
 [97] "min_pitch_dumbbell"       "min_yaw_dumbbell"        
 [99] "amplitude_roll_dumbbell"  "amplitude_pitch_dumbbell"
[101] "amplitude_yaw_dumbbell"   "total_accel_dumbbell"    
[103] "var_accel_dumbbell"       "avg_roll_dumbbell"       
[105] "stddev_roll_dumbbell"     "var_roll_dumbbell"       
[107] "avg_pitch_dumbbell"       "stddev_pitch_dumbbell"   
[109] "var_pitch_dumbbell"       "avg_yaw_dumbbell"        
[111] "stddev_yaw_dumbbell"      "var_yaw_dumbbell"        
[113] "gyros_dumbbell_x"         "gyros_dumbbell_y"        
[115] "gyros_dumbbell_z"         "accel_dumbbell_x"        
[117] "accel_dumbbell_y"         "accel_dumbbell_z"        
[119] "magnet_dumbbell_x"        "magnet_dumbbell_y"       
[121] "magnet_dumbbell_z"        "roll_forearm"            
[123] "pitch_forearm"            "yaw_forearm"             
[125] "kurtosis_roll_forearm"    "kurtosis_picth_forearm"  
[127] "kurtosis_yaw_forearm"     "skewness_roll_forearm"   
[129] "skewness_pitch_forearm"   "skewness_yaw_forearm"    
[131] "max_roll_forearm"         "max_picth_forearm"       
[133] "max_yaw_forearm"          "min_roll_forearm"        
[135] "min_pitch_forearm"        "min_yaw_forearm"         
[137] "amplitude_roll_forearm"   "amplitude_pitch_forearm" 
[139] "amplitude_yaw_forearm"    "total_accel_forearm"     
[141] "var_accel_forearm"        "avg_roll_forearm"        
[143] "stddev_roll_forearm"      "var_roll_forearm"        
[145] "avg_pitch_forearm"        "stddev_pitch_forearm"    
[147] "var_pitch_forearm"        "avg_yaw_forearm"         
[149] "stddev_yaw_forearm"       "var_yaw_forearm"         
[151] "gyros_forearm_x"          "gyros_forearm_y"         
[153] "gyros_forearm_z"          "accel_forearm_x"         
[155] "accel_forearm_y"          "accel_forearm_z"         
[157] "magnet_forearm_x"         "magnet_forearm_y"        
[159] "magnet_forearm_z"         "problem_id"              

summary(train)
       X            user_name    raw_timestamp_part_1 raw_timestamp_part_2
 Min.   :    1   adelmo  :3892   Min.   :1.322e+09    Min.   :   294      
 1st Qu.: 4906   carlitos:3112   1st Qu.:1.323e+09    1st Qu.:252912      
 Median : 9812   charles :3536   Median :1.323e+09    Median :496380      
 Mean   : 9812   eurico  :3070   Mean   :1.323e+09    Mean   :500656      
 3rd Qu.:14717   jeremy  :3402   3rd Qu.:1.323e+09    3rd Qu.:751891      
 Max.   :19622   pedro   :2610   Max.   :1.323e+09    Max.   :998801      
                                                                          
          cvtd_timestamp  new_window    num_window      roll_belt        pitch_belt      
 28/11/2011 14:14: 1498   no :19216   Min.   :  1.0   Min.   :-28.90   Min.   :-55.8000  
 05/12/2011 11:24: 1497   yes:  406   1st Qu.:222.0   1st Qu.:  1.10   1st Qu.:  1.7600  
 30/11/2011 17:11: 1440               Median :424.0   Median :113.00   Median :  5.2800  
 05/12/2011 11:25: 1425               Mean   :430.6   Mean   : 64.41   Mean   :  0.3053  
 02/12/2011 14:57: 1380               3rd Qu.:644.0   3rd Qu.:123.00   3rd Qu.: 14.9000  
 02/12/2011 13:34: 1375               Max.   :864.0   Max.   :162.00   Max.   : 60.3000  
 (Other)         :11007                                                                  
    yaw_belt       total_accel_belt kurtosis_roll_belt kurtosis_picth_belt
 Min.   :-180.00   Min.   : 0.00             :19216             :19216    
 1st Qu.: -88.30   1st Qu.: 3.00    #DIV/0!  :   10    #DIV/0!  :   32    
 Median : -13.00   Median :17.00    -1.908453:    2    47.000000:    4    
 Mean   : -11.21   Mean   :11.31    -0.016850:    1    -0.150950:    3    
 3rd Qu.:  12.90   3rd Qu.:18.00    -0.021024:    1    -0.684748:    3    
 Max.   : 179.00   Max.   :29.00    -0.025513:    1    -1.750749:    3    
                                    (Other)  :  391    (Other)  :  361    
 kurtosis_yaw_belt skewness_roll_belt skewness_roll_belt.1 skewness_yaw_belt
        :19216              :19216             :19216             :19216    
 #DIV/0!:  406     #DIV/0!  :    9    #DIV/0!  :   32      #DIV/0!:  406    
                   0.000000 :    4    0.000000 :    4                       
                   0.422463 :    2    -2.156553:    3                       
                   -0.003095:    1    -3.072669:    3                       
                   -0.010002:    1    -6.324555:    3                       
                   (Other)  :  389    (Other)  :  361                       
 max_roll_belt     max_picth_belt   max_yaw_belt   min_roll_belt     min_pitch_belt 
 Min.   :-94.300   Min.   : 3.00          :19216   Min.   :-180.00   Min.   : 0.00  
 1st Qu.:-88.000   1st Qu.: 5.00   -1.1   :   30   1st Qu.: -88.40   1st Qu.: 3.00  
 Median : -5.100   Median :18.00   -1.4   :   29   Median :  -7.85   Median :16.00  
 Mean   : -6.667   Mean   :12.92   -1.2   :   26   Mean   : -10.44   Mean   :10.76  
 3rd Qu.: 18.500   3rd Qu.:19.00   -0.9   :   24   3rd Qu.:   9.05   3rd Qu.:17.00  
 Max.   :180.000   Max.   :30.00   -1.3   :   22   Max.   : 173.00   Max.   :23.00  
 NA's   :19216     NA's   :19216   (Other):  275   NA's   :19216     NA's   :19216  
  min_yaw_belt   amplitude_roll_belt amplitude_pitch_belt amplitude_yaw_belt
        :19216   Min.   :  0.000     Min.   : 0.000              :19216     
 -1.1   :   30   1st Qu.:  0.300     1st Qu.: 1.000       #DIV/0!:   10     
 -1.4   :   29   Median :  1.000     Median : 1.000       0.00   :   12     
 -1.2   :   26   Mean   :  3.769     Mean   : 2.167       0.0000 :  384     
 -0.9   :   24   3rd Qu.:  2.083     3rd Qu.: 2.000                         
 -1.3   :   22   Max.   :360.000     Max.   :12.000                         
 (Other):  275   NA's   :19216       NA's   :19216                          
 var_total_accel_belt avg_roll_belt    stddev_roll_belt var_roll_belt    
 Min.   : 0.000       Min.   :-27.40   Min.   : 0.000   Min.   :  0.000  
 1st Qu.: 0.100       1st Qu.:  1.10   1st Qu.: 0.200   1st Qu.:  0.000  
 Median : 0.200       Median :116.35   Median : 0.400   Median :  0.100  
 Mean   : 0.926       Mean   : 68.06   Mean   : 1.337   Mean   :  7.699  
 3rd Qu.: 0.300       3rd Qu.:123.38   3rd Qu.: 0.700   3rd Qu.:  0.500  
 Max.   :16.500       Max.   :157.40   Max.   :14.200   Max.   :200.700  
 NA's   :19216        NA's   :19216    NA's   :19216    NA's   :19216    
 avg_pitch_belt    stddev_pitch_belt var_pitch_belt    avg_yaw_belt      stddev_yaw_belt  
 Min.   :-51.400   Min.   :0.000     Min.   : 0.000   Min.   :-138.300   Min.   :  0.000  
 1st Qu.:  2.025   1st Qu.:0.200     1st Qu.: 0.000   1st Qu.: -88.175   1st Qu.:  0.100  
 Median :  5.200   Median :0.400     Median : 0.100   Median :  -6.550   Median :  0.300  
 Mean   :  0.520   Mean   :0.603     Mean   : 0.766   Mean   :  -8.831   Mean   :  1.341  
 3rd Qu.: 15.775   3rd Qu.:0.700     3rd Qu.: 0.500   3rd Qu.:  14.125   3rd Qu.:  0.700  
 Max.   : 59.700   Max.   :4.000     Max.   :16.200   Max.   : 173.500   Max.   :176.600  
 NA's   :19216     NA's   :19216     NA's   :19216    NA's   :19216      NA's   :19216    
  var_yaw_belt        gyros_belt_x        gyros_belt_y       gyros_belt_z    
 Min.   :    0.000   Min.   :-1.040000   Min.   :-0.64000   Min.   :-1.4600  
 1st Qu.:    0.010   1st Qu.:-0.030000   1st Qu.: 0.00000   1st Qu.:-0.2000  
 Median :    0.090   Median : 0.030000   Median : 0.02000   Median :-0.1000  
 Mean   :  107.487   Mean   :-0.005592   Mean   : 0.03959   Mean   :-0.1305  
 3rd Qu.:    0.475   3rd Qu.: 0.110000   3rd Qu.: 0.11000   3rd Qu.:-0.0200  
 Max.   :31183.240   Max.   : 2.220000   Max.   : 0.64000   Max.   : 1.6200  
 NA's   :19216                                                               
  accel_belt_x       accel_belt_y     accel_belt_z     magnet_belt_x   magnet_belt_y  
 Min.   :-120.000   Min.   :-69.00   Min.   :-275.00   Min.   :-52.0   Min.   :354.0  
 1st Qu.: -21.000   1st Qu.:  3.00   1st Qu.:-162.00   1st Qu.:  9.0   1st Qu.:581.0  
 Median : -15.000   Median : 35.00   Median :-152.00   Median : 35.0   Median :601.0  
 Mean   :  -5.595   Mean   : 30.15   Mean   : -72.59   Mean   : 55.6   Mean   :593.7  
 3rd Qu.:  -5.000   3rd Qu.: 61.00   3rd Qu.:  27.00   3rd Qu.: 59.0   3rd Qu.:610.0  
 Max.   :  85.000   Max.   :164.00   Max.   : 105.00   Max.   :485.0   Max.   :673.0  
                                                                                      
 magnet_belt_z       roll_arm         pitch_arm          yaw_arm          total_accel_arm
 Min.   :-623.0   Min.   :-180.00   Min.   :-88.800   Min.   :-180.0000   Min.   : 1.00  
 1st Qu.:-375.0   1st Qu.: -31.77   1st Qu.:-25.900   1st Qu.: -43.1000   1st Qu.:17.00  
 Median :-320.0   Median :   0.00   Median :  0.000   Median :   0.0000   Median :27.00  
 Mean   :-345.5   Mean   :  17.83   Mean   : -4.612   Mean   :  -0.6188   Mean   :25.51  
 3rd Qu.:-306.0   3rd Qu.:  77.30   3rd Qu.: 11.200   3rd Qu.:  45.8750   3rd Qu.:33.00  
 Max.   : 293.0   Max.   : 180.00   Max.   : 88.500   Max.   : 180.0000   Max.   :66.00  
                                                                                         
 var_accel_arm     avg_roll_arm     stddev_roll_arm    var_roll_arm      
 Min.   :  0.00   Min.   :-166.67   Min.   :  0.000   Min.   :    0.000  
 1st Qu.:  9.03   1st Qu.: -38.37   1st Qu.:  1.376   1st Qu.:    1.898  
 Median : 40.61   Median :   0.00   Median :  5.702   Median :   32.517  
 Mean   : 53.23   Mean   :  12.68   Mean   : 11.201   Mean   :  417.264  
 3rd Qu.: 75.62   3rd Qu.:  76.33   3rd Qu.: 14.921   3rd Qu.:  222.647  
 Max.   :331.70   Max.   : 163.33   Max.   :161.964   Max.   :26232.208  
 NA's   :19216    NA's   :19216     NA's   :19216     NA's   :19216      
 avg_pitch_arm     stddev_pitch_arm var_pitch_arm       avg_yaw_arm      
 Min.   :-81.773   Min.   : 0.000   Min.   :   0.000   Min.   :-173.440  
 1st Qu.:-22.770   1st Qu.: 1.642   1st Qu.:   2.697   1st Qu.: -29.198  
 Median :  0.000   Median : 8.133   Median :  66.146   Median :   0.000  
 Mean   : -4.901   Mean   :10.383   Mean   : 195.864   Mean   :   2.359  
 3rd Qu.:  8.277   3rd Qu.:16.327   3rd Qu.: 266.576   3rd Qu.:  38.185  
 Max.   : 75.659   Max.   :43.412   Max.   :1884.565   Max.   : 152.000  
 NA's   :19216     NA's   :19216    NA's   :19216      NA's   :19216     
 stddev_yaw_arm     var_yaw_arm         gyros_arm_x        gyros_arm_y     
 Min.   :  0.000   Min.   :    0.000   Min.   :-6.37000   Min.   :-3.4400  
 1st Qu.:  2.577   1st Qu.:    6.642   1st Qu.:-1.33000   1st Qu.:-0.8000  
 Median : 16.682   Median :  278.309   Median : 0.08000   Median :-0.2400  
 Mean   : 22.270   Mean   : 1055.933   Mean   : 0.04277   Mean   :-0.2571  
 3rd Qu.: 35.984   3rd Qu.: 1294.850   3rd Qu.: 1.57000   3rd Qu.: 0.1400  
 Max.   :177.044   Max.   :31344.568   Max.   : 4.87000   Max.   : 2.8400  
 NA's   :19216     NA's   :19216                                           
  gyros_arm_z       accel_arm_x       accel_arm_y      accel_arm_z       magnet_arm_x   
 Min.   :-2.3300   Min.   :-404.00   Min.   :-318.0   Min.   :-636.00   Min.   :-584.0  
 1st Qu.:-0.0700   1st Qu.:-242.00   1st Qu.: -54.0   1st Qu.:-143.00   1st Qu.:-300.0  
 Median : 0.2300   Median : -44.00   Median :  14.0   Median : -47.00   Median : 289.0  
 Mean   : 0.2695   Mean   : -60.24   Mean   :  32.6   Mean   : -71.25   Mean   : 191.7  
 3rd Qu.: 0.7200   3rd Qu.:  84.00   3rd Qu.: 139.0   3rd Qu.:  23.00   3rd Qu.: 637.0  
 Max.   : 3.0200   Max.   : 437.00   Max.   : 308.0   Max.   : 292.00   Max.   : 782.0  
                                                                                        
  magnet_arm_y     magnet_arm_z    kurtosis_roll_arm kurtosis_picth_arm kurtosis_yaw_arm
 Min.   :-392.0   Min.   :-597.0           :19216            :19216             :19216  
 1st Qu.:  -9.0   1st Qu.: 131.2   #DIV/0! :   78    #DIV/0! :   80     #DIV/0! :   11  
 Median : 202.0   Median : 444.0   -0.02438:    1    -0.00484:    1     0.55844 :    2  
 Mean   : 156.6   Mean   : 306.5   -0.04190:    1    -0.01311:    1     0.65132 :    2  
 3rd Qu.: 323.0   3rd Qu.: 545.0   -0.05051:    1    -0.02967:    1     -0.01548:    1  
 Max.   : 583.0   Max.   : 694.0   -0.05695:    1    -0.07394:    1     -0.01749:    1  
                                   (Other) :  324    (Other) :  322     (Other) :  389  
 skewness_roll_arm skewness_pitch_arm skewness_yaw_arm  max_roll_arm    
         :19216            :19216             :19216   Min.   :-73.100  
 #DIV/0! :   77    #DIV/0! :   80     #DIV/0! :   11   1st Qu.: -0.175  
 -0.00051:    1    -0.00184:    1     -1.62032:    2   Median :  4.950  
 -0.00696:    1    -0.01185:    1     0.55053 :    2   Mean   : 11.236  
 -0.01884:    1    -0.01247:    1     -0.00311:    1   3rd Qu.: 26.775  
 -0.03359:    1    -0.02063:    1     -0.00562:    1   Max.   : 85.500  
 (Other) :  325    (Other) :  322     (Other) :  389   NA's   :19216    
 max_picth_arm       max_yaw_arm     min_roll_arm    min_pitch_arm      min_yaw_arm   
 Min.   :-173.000   Min.   : 4.00   Min.   :-89.10   Min.   :-180.00   Min.   : 1.00  
 1st Qu.:  -1.975   1st Qu.:29.00   1st Qu.:-41.98   1st Qu.: -72.62   1st Qu.: 8.00  
 Median :  23.250   Median :34.00   Median :-22.45   Median : -33.85   Median :13.00  
 Mean   :  35.751   Mean   :35.46   Mean   :-21.22   Mean   : -33.92   Mean   :14.66  
 3rd Qu.:  95.975   3rd Qu.:41.00   3rd Qu.:  0.00   3rd Qu.:   0.00   3rd Qu.:19.00  
 Max.   : 180.000   Max.   :65.00   Max.   : 66.40   Max.   : 152.00   Max.   :38.00  
 NA's   :19216      NA's   :19216   NA's   :19216    NA's   :19216     NA's   :19216  
 amplitude_roll_arm amplitude_pitch_arm amplitude_yaw_arm roll_dumbbell    
 Min.   :  0.000    Min.   :  0.000     Min.   : 0.00     Min.   :-153.71  
 1st Qu.:  5.425    1st Qu.:  9.925     1st Qu.:13.00     1st Qu.: -18.49  
 Median : 28.450    Median : 54.900     Median :22.00     Median :  48.17  
 Mean   : 32.452    Mean   : 69.677     Mean   :20.79     Mean   :  23.84  
 3rd Qu.: 50.960    3rd Qu.:115.175     3rd Qu.:28.75     3rd Qu.:  67.61  
 Max.   :119.500    Max.   :360.000     Max.   :52.00     Max.   : 153.55  
 NA's   :19216      NA's   :19216       NA's   :19216                      
 pitch_dumbbell     yaw_dumbbell      kurtosis_roll_dumbbell kurtosis_picth_dumbbell
 Min.   :-149.59   Min.   :-150.871          :19216                 :19216          
 1st Qu.: -40.89   1st Qu.: -77.644   #DIV/0!:    5          -0.5464:    2          
 Median : -20.96   Median :  -3.324   -0.2583:    2          -0.9334:    2          
 Mean   : -10.78   Mean   :   1.674   -0.3705:    2          -2.0833:    2          
 3rd Qu.:  17.50   3rd Qu.:  79.643   -0.5855:    2          -2.0851:    2          
 Max.   : 149.40   Max.   : 154.952   -2.0851:    2          -2.0889:    2          
                                      (Other):  393          (Other):  396          
 kurtosis_yaw_dumbbell skewness_roll_dumbbell skewness_pitch_dumbbell
        :19216                :19216                 :19216          
 #DIV/0!:  406         #DIV/0!:    4          -0.2328:    2          
                       -0.9324:    2          -0.3521:    2          
                       0.1110 :    2          -0.7036:    2          
                       1.0312 :    2          0.1090 :    2          
                       -0.0082:    1          1.0326 :    2          
                       (Other):  395          (Other):  396          
 skewness_yaw_dumbbell max_roll_dumbbell max_picth_dumbbell max_yaw_dumbbell
        :19216         Min.   :-70.10    Min.   :-112.90           :19216   
 #DIV/0!:  406         1st Qu.:-27.15    1st Qu.: -66.70    -0.6   :   20   
                       Median : 14.85    Median :  40.05    0.2    :   19   
                       Mean   : 13.76    Mean   :  32.75    -0.8   :   18   
                       3rd Qu.: 50.58    3rd Qu.: 133.22    -0.3   :   16   
                       Max.   :137.00    Max.   : 155.00    -0.2   :   15   
                       NA's   :19216     NA's   :19216      (Other):  318   
 min_roll_dumbbell min_pitch_dumbbell min_yaw_dumbbell amplitude_roll_dumbbell
 Min.   :-149.60   Min.   :-147.00           :19216    Min.   :  0.00         
 1st Qu.: -59.67   1st Qu.: -91.80    -0.6   :   20    1st Qu.: 14.97         
 Median : -43.55   Median : -66.15    0.2    :   19    Median : 35.05         
 Mean   : -41.24   Mean   : -33.18    -0.8   :   18    Mean   : 55.00         
 3rd Qu.: -25.20   3rd Qu.:  21.20    -0.3   :   16    3rd Qu.: 81.04         
 Max.   :  73.20   Max.   : 120.90    -0.2   :   15    Max.   :256.48         
 NA's   :19216     NA's   :19216      (Other):  318    NA's   :19216          
 amplitude_pitch_dumbbell amplitude_yaw_dumbbell total_accel_dumbbell var_accel_dumbbell
 Min.   :  0.00                  :19216          Min.   : 0.00        Min.   :  0.000   
 1st Qu.: 17.06           #DIV/0!:    5          1st Qu.: 4.00        1st Qu.:  0.378   
 Median : 41.73           0.00   :  401          Median :10.00        Median :  1.000   
 Mean   : 65.93                                  Mean   :13.72        Mean   :  4.388   
 3rd Qu.: 99.55                                  3rd Qu.:19.00        3rd Qu.:  3.434   
 Max.   :273.59                                  Max.   :58.00        Max.   :230.428   
 NA's   :19216                                                        NA's   :19216     
 avg_roll_dumbbell stddev_roll_dumbbell var_roll_dumbbell  avg_pitch_dumbbell
 Min.   :-128.96   Min.   :  0.000      Min.   :    0.00   Min.   :-70.73    
 1st Qu.: -12.33   1st Qu.:  4.639      1st Qu.:   21.52   1st Qu.:-42.00    
 Median :  48.23   Median : 12.204      Median :  148.95   Median :-19.91    
 Mean   :  23.86   Mean   : 20.761      Mean   : 1020.27   Mean   :-12.33    
 3rd Qu.:  64.37   3rd Qu.: 26.356      3rd Qu.:  694.65   3rd Qu.: 13.21    
 Max.   : 125.99   Max.   :123.778      Max.   :15321.01   Max.   : 94.28    
 NA's   :19216     NA's   :19216        NA's   :19216      NA's   :19216     
 stddev_pitch_dumbbell var_pitch_dumbbell avg_yaw_dumbbell   stddev_yaw_dumbbell
 Min.   : 0.000        Min.   :   0.00    Min.   :-117.950   Min.   :  0.000    
 1st Qu.: 3.482        1st Qu.:  12.12    1st Qu.: -76.696   1st Qu.:  3.885    
 Median : 8.089        Median :  65.44    Median :  -4.505   Median : 10.264    
 Mean   :13.147        Mean   : 350.31    Mean   :   0.202   Mean   : 16.647    
 3rd Qu.:19.238        3rd Qu.: 370.11    3rd Qu.:  71.234   3rd Qu.: 24.674    
 Max.   :82.680        Max.   :6836.02    Max.   : 134.905   Max.   :107.088    
 NA's   :19216         NA's   :19216      NA's   :19216      NA's   :19216      
 var_yaw_dumbbell   gyros_dumbbell_x    gyros_dumbbell_y   gyros_dumbbell_z 
 Min.   :    0.00   Min.   :-204.0000   Min.   :-2.10000   Min.   : -2.380  
 1st Qu.:   15.09   1st Qu.:  -0.0300   1st Qu.:-0.14000   1st Qu.: -0.310  
 Median :  105.35   Median :   0.1300   Median : 0.03000   Median : -0.130  
 Mean   :  589.84   Mean   :   0.1611   Mean   : 0.04606   Mean   : -0.129  
 3rd Qu.:  608.79   3rd Qu.:   0.3500   3rd Qu.: 0.21000   3rd Qu.:  0.030  
 Max.   :11467.91   Max.   :   2.2200   Max.   :52.00000   Max.   :317.000  
 NA's   :19216                                                              
 accel_dumbbell_x  accel_dumbbell_y  accel_dumbbell_z  magnet_dumbbell_x magnet_dumbbell_y
 Min.   :-419.00   Min.   :-189.00   Min.   :-334.00   Min.   :-643.0    Min.   :-3600    
 1st Qu.: -50.00   1st Qu.:  -8.00   1st Qu.:-142.00   1st Qu.:-535.0    1st Qu.:  231    
 Median :  -8.00   Median :  41.50   Median :  -1.00   Median :-479.0    Median :  311    
 Mean   : -28.62   Mean   :  52.63   Mean   : -38.32   Mean   :-328.5    Mean   :  221    
 3rd Qu.:  11.00   3rd Qu.: 111.00   3rd Qu.:  38.00   3rd Qu.:-304.0    3rd Qu.:  390    
 Max.   : 235.00   Max.   : 315.00   Max.   : 318.00   Max.   : 592.0    Max.   :  633    
                                                                                          
 magnet_dumbbell_z  roll_forearm       pitch_forearm     yaw_forearm     
 Min.   :-262.00   Min.   :-180.0000   Min.   :-72.50   Min.   :-180.00  
 1st Qu.: -45.00   1st Qu.:  -0.7375   1st Qu.:  0.00   1st Qu.: -68.60  
 Median :  13.00   Median :  21.7000   Median :  9.24   Median :   0.00  
 Mean   :  46.05   Mean   :  33.8265   Mean   : 10.71   Mean   :  19.21  
 3rd Qu.:  95.00   3rd Qu.: 140.0000   3rd Qu.: 28.40   3rd Qu.: 110.00  
 Max.   : 452.00   Max.   : 180.0000   Max.   : 89.80   Max.   : 180.00  
                                                                         
 kurtosis_roll_forearm kurtosis_picth_forearm kurtosis_yaw_forearm skewness_roll_forearm
        :19216                :19216                 :19216               :19216        
 #DIV/0!:   84         #DIV/0!:   85          #DIV/0!:  406        #DIV/0!:   83        
 -0.8079:    2         -0.0073:    1                               -0.1912:    2        
 -0.9169:    2         -0.0442:    1                               -0.4126:    2        
 -0.0227:    1         -0.0489:    1                               -0.0004:    1        
 -0.0359:    1         -0.0523:    1                               -0.0013:    1        
 (Other):  316         (Other):  317                               (Other):  317        
 skewness_pitch_forearm skewness_yaw_forearm max_roll_forearm max_picth_forearm
        :19216                 :19216        Min.   :-66.60   Min.   :-151.00  
 #DIV/0!:   85          #DIV/0!:  406        1st Qu.:  0.00   1st Qu.:   0.00  
 0.0000 :    4                               Median : 26.80   Median : 113.00  
 -0.6992:    2                               Mean   : 24.49   Mean   :  81.49  
 -0.0113:    1                               3rd Qu.: 45.95   3rd Qu.: 174.75  
 -0.0131:    1                               Max.   : 89.80   Max.   : 180.00  
 (Other):  313                               NA's   :19216    NA's   :19216    
 max_yaw_forearm min_roll_forearm  min_pitch_forearm min_yaw_forearm
        :19216   Min.   :-72.500   Min.   :-180.00          :19216  
 #DIV/0!:   84   1st Qu.: -6.075   1st Qu.:-175.00   #DIV/0!:   84  
 -1.2   :   32   Median :  0.000   Median : -61.00   -1.2   :   32  
 -1.3   :   31   Mean   : -0.167   Mean   : -57.57   -1.3   :   31  
 -1.4   :   24   3rd Qu.: 12.075   3rd Qu.:   0.00   -1.4   :   24  
 -1.5   :   24   Max.   : 62.100   Max.   : 167.00   -1.5   :   24  
 (Other):  211   NA's   :19216     NA's   :19216     (Other):  211  
 amplitude_roll_forearm amplitude_pitch_forearm amplitude_yaw_forearm total_accel_forearm
 Min.   :  0.000        Min.   :  0.0                  :19216         Min.   :  0.00     
 1st Qu.:  1.125        1st Qu.:  2.0           #DIV/0!:   84         1st Qu.: 29.00     
 Median : 17.770        Median : 83.7           0.00   :  322         Median : 36.00     
 Mean   : 24.653        Mean   :139.1                                 Mean   : 34.72     
 3rd Qu.: 39.875        3rd Qu.:350.0                                 3rd Qu.: 41.00     
 Max.   :126.000        Max.   :360.0                                 Max.   :108.00     
 NA's   :19216          NA's   :19216                                                    
 var_accel_forearm avg_roll_forearm   stddev_roll_forearm var_roll_forearm  
 Min.   :  0.000   Min.   :-177.234   Min.   :  0.000     Min.   :    0.00  
 1st Qu.:  6.759   1st Qu.:  -0.909   1st Qu.:  0.428     1st Qu.:    0.18  
 Median : 21.165   Median :  11.172   Median :  8.030     Median :   64.48  
 Mean   : 33.502   Mean   :  33.165   Mean   : 41.986     Mean   : 5274.10  
 3rd Qu.: 51.240   3rd Qu.: 107.132   3rd Qu.: 85.373     3rd Qu.: 7289.08  
 Max.   :172.606   Max.   : 177.256   Max.   :179.171     Max.   :32102.24  
 NA's   :19216     NA's   :19216      NA's   :19216       NA's   :19216     
 avg_pitch_forearm stddev_pitch_forearm var_pitch_forearm  avg_yaw_forearm  
 Min.   :-68.17    Min.   : 0.000       Min.   :   0.000   Min.   :-155.06  
 1st Qu.:  0.00    1st Qu.: 0.336       1st Qu.:   0.113   1st Qu.: -26.26  
 Median : 12.02    Median : 5.516       Median :  30.425   Median :   0.00  
 Mean   : 11.79    Mean   : 7.977       Mean   : 139.593   Mean   :  18.00  
 3rd Qu.: 28.48    3rd Qu.:12.866       3rd Qu.: 165.532   3rd Qu.:  85.79  
 Max.   : 72.09    Max.   :47.745       Max.   :2279.617   Max.   : 169.24  
 NA's   :19216     NA's   :19216        NA's   :19216      NA's   :19216    
 stddev_yaw_forearm var_yaw_forearm    gyros_forearm_x   gyros_forearm_y    
 Min.   :  0.000    Min.   :    0.00   Min.   :-22.000   Min.   : -7.02000  
 1st Qu.:  0.524    1st Qu.:    0.27   1st Qu.: -0.220   1st Qu.: -1.46000  
 Median : 24.743    Median :  612.21   Median :  0.050   Median :  0.03000  
 Mean   : 44.854    Mean   : 4639.85   Mean   :  0.158   Mean   :  0.07517  
 3rd Qu.: 85.817    3rd Qu.: 7368.41   3rd Qu.:  0.560   3rd Qu.:  1.62000  
 Max.   :197.508    Max.   :39009.33   Max.   :  3.970   Max.   :311.00000  
 NA's   :19216      NA's   :19216                                           
 gyros_forearm_z    accel_forearm_x   accel_forearm_y  accel_forearm_z   magnet_forearm_x 
 Min.   : -8.0900   Min.   :-498.00   Min.   :-632.0   Min.   :-446.00   Min.   :-1280.0  
 1st Qu.: -0.1800   1st Qu.:-178.00   1st Qu.:  57.0   1st Qu.:-182.00   1st Qu.: -616.0  
 Median :  0.0800   Median : -57.00   Median : 201.0   Median : -39.00   Median : -378.0  
 Mean   :  0.1512   Mean   : -61.65   Mean   : 163.7   Mean   : -55.29   Mean   : -312.6  
 3rd Qu.:  0.4900   3rd Qu.:  76.00   3rd Qu.: 312.0   3rd Qu.:  26.00   3rd Qu.:  -73.0  
 Max.   :231.0000   Max.   : 477.00   Max.   : 923.0   Max.   : 291.00   Max.   :  672.0  
                                                                                          
 magnet_forearm_y magnet_forearm_z classe  
 Min.   :-896.0   Min.   :-973.0   A:5580  
 1st Qu.:   2.0   1st Qu.: 191.0   B:3797  
 Median : 591.0   Median : 511.0   C:3422  
 Mean   : 380.1   Mean   : 393.6   D:3216  
 3rd Qu.: 737.0   3rd Qu.: 653.0   E:3607  
 Max.   :1480.0   Max.   :1090.0           
                                           


#REMOVE THE NA VARIABLES
newtrain=train[c(-2,-12:-36,-50:-59,-69:-83,-87:-101,-103:-112,-125:-139,-141:-150)]
newtest=test[c(-2,-12:-36,-50:-59,-69:-83,-87:-101,-103:-112,-125:-139,-141:-150)]

dim(newtrain)
[1] 19622    59
dim(newtest)
[1] 20 59


#CREATE VALIDATION SET
inValidation=createDataPartition(y=newtrain$classee, p=0.7, list=FALSE)
Error in createDataPartition(y = newtrain$classee, p = 0.7, list = FALSE) : 
  y must have at least 2 data points
inValidation=createDataPartition(y=newtrain$classe, p=0.7, list=FALSE)
training=newtrain[inValidation,]


#CREATE VALIDATION SET (correction)
inTrain=createDataPartition(y=newtrain$classe, p=0.7, list=FALSE)
training=newtrain[inTrain,]
validation=newtrain[-inTrain,]

dim(training)
[1] 13737    59
dim(validation)
[1] 5885   59
dim(test)
[1]  20 160


dim(training)
[1] 13737    59
dim(validation)
[1] 5885   59
dim(newtest)
[1] 20 59


#MODELING

names(training)
 [1] "X"                    "raw_timestamp_part_1" "raw_timestamp_part_2" "cvtd_timestamp"       "new_window"          
 [6] "num_window"           "roll_belt"            "pitch_belt"           "yaw_belt"             "total_accel_belt"    
[11] "gyros_belt_x"         "gyros_belt_y"         "gyros_belt_z"         "accel_belt_x"         "accel_belt_y"        
[16] "accel_belt_z"         "magnet_belt_x"        "magnet_belt_y"        "magnet_belt_z"        "roll_arm"            
[21] "pitch_arm"            "yaw_arm"              "total_accel_arm"      "gyros_arm_x"          "gyros_arm_y"         
[26] "gyros_arm_z"          "accel_arm_x"          "accel_arm_y"          "accel_arm_z"          "magnet_arm_x"        
[31] "magnet_arm_y"         "magnet_arm_z"         "roll_dumbbell"        "pitch_dumbbell"       "yaw_dumbbell"        
[36] "total_accel_dumbbell" "gyros_dumbbell_x"     "gyros_dumbbell_y"     "gyros_dumbbell_z"     "accel_dumbbell_x"    
[41] "accel_dumbbell_y"     "accel_dumbbell_z"     "magnet_dumbbell_x"    "magnet_dumbbell_y"    "magnet_dumbbell_z"   
[46] "roll_forearm"         "pitch_forearm"        "yaw_forearm"          "total_accel_forearm"  "gyros_forearm_x"     
[51] "gyros_forearm_y"      "gyros_forearm_z"      "accel_forearm_x"      "accel_forearm_y"      "accel_forearm_z"     
[56] "magnet_forearm_x"     "magnet_forearm_y"     "magnet_forearm_z"     "classe"              
summary(training)
       X         raw_timestamp_part_1 raw_timestamp_part_2          cvtd_timestamp new_window    num_window    roll_belt    
 Min.   :    1   Min.   :1.322e+09    Min.   :   301       05/12/2011 11:24:1069   no :13438   Min.   :  1   Min.   :-28.9  
 1st Qu.: 4910   1st Qu.:1.323e+09    1st Qu.:252303       28/11/2011 14:14:1046   yes:  299   1st Qu.:223   1st Qu.:  1.1  
 Median : 9825   Median :1.323e+09    Median :498060       30/11/2011 17:11:1005               Median :426   Median :113.0  
 Mean   : 9812   Mean   :1.323e+09    Mean   :500696       05/12/2011 11:25: 972               Mean   :431   Mean   : 64.5  
 3rd Qu.:14731   3rd Qu.:1.323e+09    3rd Qu.:752291       02/12/2011 14:57: 971               3rd Qu.:644   3rd Qu.:123.0  
 Max.   :19622   Max.   :1.323e+09    Max.   :998801       02/12/2011 14:58: 962               Max.   :864   Max.   :162.0  
                                                           (Other)         :7712                                            
   pitch_belt          yaw_belt       total_accel_belt  gyros_belt_x        gyros_belt_y       gyros_belt_z      accel_belt_x    
 Min.   :-55.8000   Min.   :-180.00   Min.   : 0.00    Min.   :-1.040000   Min.   :-0.64000   Min.   :-1.4600   Min.   :-82.000  
 1st Qu.:  1.7600   1st Qu.: -88.30   1st Qu.: 3.00    1st Qu.:-0.030000   1st Qu.: 0.00000   1st Qu.:-0.1800   1st Qu.:-21.000  
 Median :  5.2800   Median : -12.70   Median :17.00    Median : 0.030000   Median : 0.02000   Median :-0.1000   Median :-15.000  
 Mean   :  0.2173   Mean   : -10.88   Mean   :11.32    Mean   :-0.005019   Mean   : 0.04017   Mean   :-0.1286   Mean   : -5.461  
 3rd Qu.: 14.8000   3rd Qu.:  13.70   3rd Qu.:18.00    3rd Qu.: 0.110000   3rd Qu.: 0.11000   3rd Qu.:-0.0200   3rd Qu.: -5.000  
 Max.   : 60.3000   Max.   : 179.00   Max.   :29.00    Max.   : 2.220000   Max.   : 0.64000   Max.   : 1.6200   Max.   : 85.000  
                                                                                                                                 
  accel_belt_y     accel_belt_z     magnet_belt_x   magnet_belt_y   magnet_belt_z       roll_arm         pitch_arm      
 Min.   :-54.00   Min.   :-275.00   Min.   :-52.0   Min.   :354.0   Min.   :-623.0   Min.   :-180.00   Min.   :-88.800  
 1st Qu.:  3.00   1st Qu.:-162.00   1st Qu.:  9.0   1st Qu.:581.0   1st Qu.:-375.0   1st Qu.: -31.80   1st Qu.:-25.800  
 Median : 34.00   Median :-152.00   Median : 35.0   Median :601.0   Median :-319.0   Median :   0.00   Median :  0.000  
 Mean   : 30.16   Mean   : -72.74   Mean   : 55.6   Mean   :593.7   Mean   :-345.6   Mean   :  17.52   Mean   : -4.651  
 3rd Qu.: 61.00   3rd Qu.:  27.00   3rd Qu.: 59.0   3rd Qu.:610.0   3rd Qu.:-306.0   3rd Qu.:  77.40   3rd Qu.: 11.100  
 Max.   :150.00   Max.   : 103.00   Max.   :485.0   Max.   :673.0   Max.   : 293.0   Max.   : 180.00   Max.   : 88.500  
                                                                                                                        
    yaw_arm          total_accel_arm  gyros_arm_x        gyros_arm_y       gyros_arm_z       accel_arm_x       accel_arm_y     
 Min.   :-180.0000   Min.   : 1.00   Min.   :-6.37000   Min.   :-3.4400   Min.   :-2.3300   Min.   :-404.00   Min.   :-315.00  
 1st Qu.: -43.4000   1st Qu.:17.00   1st Qu.:-1.33000   1st Qu.:-0.8000   1st Qu.:-0.0700   1st Qu.:-242.00   1st Qu.: -55.00  
 Median :   0.0000   Median :27.00   Median : 0.08000   Median :-0.2400   Median : 0.2500   Median : -43.00   Median :  13.00  
 Mean   :  -0.4604   Mean   :25.49   Mean   : 0.03775   Mean   :-0.2561   Mean   : 0.2718   Mean   : -60.63   Mean   :  32.19  
 3rd Qu.:  46.1000   3rd Qu.:33.00   3rd Qu.: 1.56000   3rd Qu.: 0.1400   3rd Qu.: 0.7200   3rd Qu.:  83.00   3rd Qu.: 140.00  
 Max.   : 180.0000   Max.   :66.00   Max.   : 4.87000   Max.   : 2.8400   Max.   : 3.0200   Max.   : 437.00   Max.   : 303.00  
                                                                                                                               
  accel_arm_z       magnet_arm_x     magnet_arm_y     magnet_arm_z    roll_dumbbell     pitch_dumbbell     yaw_dumbbell     
 Min.   :-636.00   Min.   :-580.0   Min.   :-392.0   Min.   :-597.0   Min.   :-153.71   Min.   :-134.73   Min.   :-150.871  
 1st Qu.:-141.00   1st Qu.:-300.0   1st Qu.: -11.0   1st Qu.: 126.0   1st Qu.: -18.16   1st Qu.: -40.94   1st Qu.: -77.789  
 Median : -47.00   Median : 288.0   Median : 201.0   Median : 445.0   Median :  48.18   Median : -20.94   Median :  -3.185  
 Mean   : -71.64   Mean   : 191.1   Mean   : 155.9   Mean   : 305.4   Mean   :  23.91   Mean   : -10.83   Mean   :   1.378  
 3rd Qu.:  23.00   3rd Qu.: 635.0   3rd Qu.: 323.0   3rd Qu.: 544.0   3rd Qu.:  67.68   3rd Qu.:  17.30   3rd Qu.:  79.464  
 Max.   : 239.00   Max.   : 782.0   Max.   : 583.0   Max.   : 694.0   Max.   : 153.55   Max.   : 149.40   Max.   : 154.754  
                                                                                                                            
 total_accel_dumbbell gyros_dumbbell_x    gyros_dumbbell_y   gyros_dumbbell_z   accel_dumbbell_x  accel_dumbbell_y  accel_dumbbell_z 
 Min.   : 0.00        Min.   :-204.0000   Min.   :-2.10000   Min.   : -2.3800   Min.   :-419.00   Min.   :-182.00   Min.   :-334.00  
 1st Qu.: 5.00        1st Qu.:  -0.0300   1st Qu.:-0.14000   1st Qu.: -0.3100   1st Qu.: -51.00   1st Qu.:  -8.00   1st Qu.:-142.00  
 Median :11.00        Median :   0.1300   Median : 0.05000   Median : -0.1300   Median :  -9.00   Median :  43.00   Median :  -1.00  
 Mean   :13.77        Mean   :   0.1539   Mean   : 0.05014   Mean   : -0.1197   Mean   : -29.12   Mean   :  52.77   Mean   : -38.56  
 3rd Qu.:20.00        3rd Qu.:   0.3500   3rd Qu.: 0.21000   3rd Qu.:  0.0300   3rd Qu.:  10.00   3rd Qu.: 112.00   3rd Qu.:  38.00  
 Max.   :58.00        Max.   :   2.2200   Max.   :52.00000   Max.   :317.0000   Max.   : 235.00   Max.   : 315.00   Max.   : 318.00  
                                                                                                                                     
 magnet_dumbbell_x magnet_dumbbell_y magnet_dumbbell_z  roll_forearm     pitch_forearm     yaw_forearm      total_accel_forearm
 Min.   :-643.0    Min.   :-3600.0   Min.   :-262.0    Min.   :-180.00   Min.   :-72.50   Min.   :-180.00   Min.   :  0.0      
 1st Qu.:-535.0    1st Qu.:  231.0   1st Qu.: -45.0    1st Qu.:  -0.59   1st Qu.:  0.00   1st Qu.: -68.20   1st Qu.: 29.0      
 Median :-480.0    Median :  311.0   Median :  13.0    Median :  21.90   Median :  8.97   Median :   0.00   Median : 36.0      
 Mean   :-330.4    Mean   :  222.2   Mean   :  46.2    Mean   :  34.23   Mean   : 10.51   Mean   :  19.57   Mean   : 34.8      
 3rd Qu.:-307.0    3rd Qu.:  391.0   3rd Qu.:  95.0    3rd Qu.: 140.00   3rd Qu.: 28.20   3rd Qu.: 110.00   3rd Qu.: 41.0      
 Max.   : 592.0    Max.   :  633.0   Max.   : 451.0    Max.   : 180.00   Max.   : 89.80   Max.   : 180.00   Max.   :108.0      
                                                                                                                               
 gyros_forearm_x    gyros_forearm_y     gyros_forearm_z    accel_forearm_x   accel_forearm_y  accel_forearm_z   magnet_forearm_x
 Min.   :-22.0000   Min.   : -7.02000   Min.   : -5.5500   Min.   :-496.00   Min.   :-632.0   Min.   :-446.00   Min.   :-1280   
 1st Qu.: -0.2100   1st Qu.: -1.46000   1st Qu.: -0.1800   1st Qu.:-178.00   1st Qu.:  57.0   1st Qu.:-181.00   1st Qu.: -617   
 Median :  0.0500   Median :  0.03000   Median :  0.0800   Median : -57.00   Median : 201.0   Median : -39.00   Median : -381   
 Mean   :  0.1578   Mean   :  0.08551   Mean   :  0.1604   Mean   : -62.79   Mean   : 163.9   Mean   : -54.89   Mean   : -314   
 3rd Qu.:  0.5800   3rd Qu.:  1.62000   3rd Qu.:  0.4900   3rd Qu.:  75.00   3rd Qu.: 313.0   3rd Qu.:  26.00   3rd Qu.:  -77   
 Max.   :  3.5200   Max.   :311.00000   Max.   :231.0000   Max.   : 477.00   Max.   : 923.0   Max.   : 291.00   Max.   :  672   
                                                                                                                                
 magnet_forearm_y magnet_forearm_z classe  
 Min.   :-896.0   Min.   :-973.0   A:3906  
 1st Qu.:   5.0   1st Qu.: 191.0   B:2658  
 Median : 593.0   Median : 512.0   C:2396  
 Mean   : 380.5   Mean   : 395.3   D:2252  
 3rd Qu.: 736.0   3rd Qu.: 654.0   E:2525  
 Max.   :1480.0   Max.   :1080.0           
                                           

training$Diff=training$raw_timestamp_part_1-training$raw_timestamp_part_2
validation$Diff=validation$raw_timestamp_part_1-validation$raw_timestamp_part_2
newtest$Diff=newtest$raw_timestamp_part_1-newtest$raw_timestamp_part_2

dim(training)
[1] 13737    60
dim(validation)
[1] 5885   60
dim(newtest)
[1] 20 60


mod1=train(classe~.-X-raw_timestamp_part_1-raw_timestamp_part_2-cvtd_timestamp, data=training, method="rpart")
names(mod1)
 [1] "method"       "modelInfo"    "modelType"    "results"      "pred"         "bestTune"     "call"         "dots"        
 [9] "metric"       "control"      "finalModel"   "preProcess"   "trainingData" "resample"     "resampledCM"  "perfNames"   
[17] "maximize"     "yLimits"      "times"        "terms"        "coefnames"    "contrasts"    "xlevels"     
pred1=predict(mod1, newdata=validation)
confusionMatrix(pred1, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1507  462  464  425  171
         B   36  386   48  183  155
         C  128  291  514  356  288
         D    0    0    0    0    0
         E    3    0    0    0  468

Overall Statistics
                                          
               Accuracy : 0.4885          
                 95% CI : (0.4757, 0.5014)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.3319          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9002  0.33889  0.50097   0.0000  0.43253
Specificity            0.6386  0.91108  0.78123   1.0000  0.99938
Pos Pred Value         0.4975  0.47772  0.32594      NaN  0.99363
Neg Pred Value         0.9415  0.85168  0.88115   0.8362  0.88659
Prevalence             0.2845  0.19354  0.17434   0.1638  0.18386
Detection Rate         0.2561  0.06559  0.08734   0.0000  0.07952
Detection Prevalence   0.5147  0.13730  0.26797   0.0000  0.08003
Balanced Accuracy      0.7694  0.62499  0.64110   0.5000  0.71595
fancyRpartPlot(mod1$finalModel)
prp(mod1$finalModel)

mod2=train(classe~.-X-raw_timestamp_part_1-raw_timestamp_part_2-cvtd_timestamp, data=training, method="rpart", trainControl="cv")
Something is wrong; all the Accuracy metric values are missing:
    Accuracy       Kappa    
 Min.   : NA   Min.   : NA  
 1st Qu.: NA   1st Qu.: NA  
 Median : NA   Median : NA  
 Mean   :NaN   Mean   :NaN  
 3rd Qu.: NA   3rd Qu.: NA  
 Max.   : NA   Max.   : NA  
 NA's   :3     NA's   :3    
Error in train.default(x, y, weights = w, ...) : Stopping
In addition: There were 26 warnings (use warnings() to see them)
pred2=predict(mod2, newdata=validation)
Error in predict(mod2, newdata = validation) : object 'mod2' not found

mod2=train(classe~.-X-raw_timestamp_part_1-raw_timestamp_part_2-cvtd_timestamp, data=training, method="rpart", trControl=trainControl(method="cv", number=10))
pred2=predict(mod2, newdata=validation)
confusionMatrix(pred2, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1507  462  464  425  171
         B   36  386   48  183  155
         C  128  291  514  356  288
         D    0    0    0    0    0
         E    3    0    0    0  468

Overall Statistics
                                          
               Accuracy : 0.4885          
                 95% CI : (0.4757, 0.5014)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.3319          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9002  0.33889  0.50097   0.0000  0.43253
Specificity            0.6386  0.91108  0.78123   1.0000  0.99938
Pos Pred Value         0.4975  0.47772  0.32594      NaN  0.99363
Neg Pred Value         0.9415  0.85168  0.88115   0.8362  0.88659
Prevalence             0.2845  0.19354  0.17434   0.1638  0.18386
Detection Rate         0.2561  0.06559  0.08734   0.0000  0.07952
Detection Prevalence   0.5147  0.13730  0.26797   0.0000  0.08003
Balanced Accuracy      0.7694  0.62499  0.64110   0.5000  0.71595
prp(mod2)
Error: the object passed to prp is not an rpart object
prp(mod2$finalModel)


mod3=train(classe~.-X-raw_timestamp_part_1-raw_timestamp_part_2-cvtd_timestamp, data=training, method="rf")

mod2$finalModel
n= 13737 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 13737 9831 A (0.28 0.19 0.17 0.16 0.18)  
   2) roll_belt< 130.5 12563 8668 A (0.31 0.21 0.19 0.18 0.11)  
     4) pitch_forearm< -33.95 1110    6 A (0.99 0.0054 0 0 0) *
     5) pitch_forearm>=-33.95 11453 8662 A (0.24 0.23 0.21 0.2 0.12)  
      10) magnet_dumbbell_y< 426.5 9515 6811 A (0.28 0.18 0.24 0.19 0.1)  
        20) roll_forearm< 121.5 5871 3445 A (0.41 0.18 0.19 0.17 0.055) *
        21) roll_forearm>=121.5 3644 2431 C (0.076 0.18 0.33 0.23 0.18) *
      11) magnet_dumbbell_y>=426.5 1938  976 B (0.045 0.5 0.042 0.22 0.19) *
   3) roll_belt>=130.5 1174   11 E (0.0094 0 0 0 0.99) *

prp(mod2$finalModel, varlen=30)


mod3=train(classe~roll_belt+pitch_forearm+magnet_dumbbell+roll_forearm, data=training, method="rf", ntree=200)
Error in eval(expr, envir, enclos) : object 'magnet_dumbbell' not found
mod3=train(classe~roll_belt+pitch_forearm+magnet_dumbbell_y+roll_forearm, data=training, method="rf", ntree=200)
pred3=predict(mod3, newdata=validation)
confusionMatrix(pred3, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1580   38    8    5    2
         B   13  936   24   24   31
         C   55   88  944   38   15
         D   24   68   41  891    8
         E    2    9    9    6 1026

Overall Statistics
                                          
               Accuracy : 0.9137          
                 95% CI : (0.9062, 0.9207)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.891           
 Mcnemar's Test P-Value : < 2.2e-16       

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9438   0.8218   0.9201   0.9243   0.9482
Specificity            0.9874   0.9806   0.9597   0.9713   0.9946
Pos Pred Value         0.9675   0.9105   0.8281   0.8634   0.9753
Neg Pred Value         0.9779   0.9582   0.9827   0.9850   0.9884
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
Detection Rate         0.2685   0.1590   0.1604   0.1514   0.1743
Detection Prevalence   0.2775   0.1747   0.1937   0.1754   0.1788
Balanced Accuracy      0.9656   0.9012   0.9399   0.9478   0.9714

mod4=train(classe~roll_belt+pitch_forearm+magnet_dumbbell_y+roll_forearm, data=training, method="gbm")
Loading required package: gbm
Loading required package: survival

Attaching package: ‘survival’

The following object is masked from ‘package:caret’:

    cluster

Loading required package: splines
Loading required package: parallel
Loaded gbm 2.1.1
Loading required package: plyr
Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1317
     2        1.5233             nan     0.1000    0.0873
     3        1.4650             nan     0.1000    0.0647
     4        1.4221             nan     0.1000    0.0506
     5        1.3888             nan     0.1000    0.0479
     6        1.3585             nan     0.1000    0.0331
     7        1.3358             nan     0.1000    0.0314
     8        1.3153             nan     0.1000    0.0264
     9        1.2984             nan     0.1000    0.0278
    10        1.2812             nan     0.1000    0.0236
    20        1.1684             nan     0.1000    0.0097
    40        1.0644             nan     0.1000    0.0052
    60        1.0016             nan     0.1000    0.0051
    80        0.9563             nan     0.1000    0.0022
   100        0.9197             nan     0.1000    0.0012
   120        0.8896             nan     0.1000    0.0018
   140        0.8640             nan     0.1000    0.0013
   150        0.8530             nan     0.1000    0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1764
     2        1.4962             nan     0.1000    0.1177
     3        1.4194             nan     0.1000    0.0874
     4        1.3625             nan     0.1000    0.0732
     5        1.3152             nan     0.1000    0.0577
     6        1.2777             nan     0.1000    0.0505
     7        1.2455             nan     0.1000    0.0405
     8        1.2180             nan     0.1000    0.0376
     9        1.1930             nan     0.1000    0.0330
    10        1.1715             nan     0.1000    0.0332
    20        1.0245             nan     0.1000    0.0145
    40        0.8673             nan     0.1000    0.0086
    60        0.7720             nan     0.1000    0.0039
    80        0.7073             nan     0.1000    0.0029
   100        0.6589             nan     0.1000    0.0035
   120        0.6217             nan     0.1000    0.0028
   140        0.5898             nan     0.1000    0.0012
   150        0.5765             nan     0.1000    0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2125
     2        1.4733             nan     0.1000    0.1365
     3        1.3846             nan     0.1000    0.1078
     4        1.3169             nan     0.1000    0.0874
     5        1.2610             nan     0.1000    0.0678
     6        1.2182             nan     0.1000    0.0633
     7        1.1744             nan     0.1000    0.0564
     8        1.1371             nan     0.1000    0.0442
     9        1.1082             nan     0.1000    0.0345
    10        1.0860             nan     0.1000    0.0348
    20        0.9115             nan     0.1000    0.0295
    40        0.7327             nan     0.1000    0.0100
    60        0.6424             nan     0.1000    0.0049
    80        0.5815             nan     0.1000    0.0035
   100        0.5359             nan     0.1000    0.0031
   120        0.4980             nan     0.1000    0.0020
   140        0.4673             nan     0.1000    0.0017
   150        0.4552             nan     0.1000    0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1236
     2        1.5240             nan     0.1000    0.0849
     3        1.4671             nan     0.1000    0.0634
     4        1.4246             nan     0.1000    0.0495
     5        1.3915             nan     0.1000    0.0398
     6        1.3644             nan     0.1000    0.0322
     7        1.3423             nan     0.1000    0.0338
     8        1.3209             nan     0.1000    0.0283
     9        1.3029             nan     0.1000    0.0227
    10        1.2873             nan     0.1000    0.0247
    20        1.1771             nan     0.1000    0.0094
    40        1.0764             nan     0.1000    0.0067
    60        1.0138             nan     0.1000    0.0039
    80        0.9695             nan     0.1000    0.0024
   100        0.9351             nan     0.1000    0.0021
   120        0.9063             nan     0.1000    0.0016
   140        0.8826             nan     0.1000    0.0015
   150        0.8721             nan     0.1000    0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1694
     2        1.4981             nan     0.1000    0.1151
     3        1.4225             nan     0.1000    0.0872
     4        1.3651             nan     0.1000    0.0670
     5        1.3201             nan     0.1000    0.0570
     6        1.2831             nan     0.1000    0.0487
     7        1.2514             nan     0.1000    0.0405
     8        1.2253             nan     0.1000    0.0361
     9        1.2014             nan     0.1000    0.0298
    10        1.1818             nan     0.1000    0.0314
    20        1.0486             nan     0.1000    0.0143
    40        0.8910             nan     0.1000    0.0064
    60        0.7974             nan     0.1000    0.0048
    80        0.7328             nan     0.1000    0.0059
   100        0.6811             nan     0.1000    0.0022
   120        0.6393             nan     0.1000    0.0017
   140        0.6053             nan     0.1000    0.0024
   150        0.5901             nan     0.1000    0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2084
     2        1.4754             nan     0.1000    0.1371
     3        1.3882             nan     0.1000    0.1004
     4        1.3228             nan     0.1000    0.0889
     5        1.2652             nan     0.1000    0.0664
     6        1.2222             nan     0.1000    0.0571
     7        1.1859             nan     0.1000    0.0466
     8        1.1549             nan     0.1000    0.0455
     9        1.1241             nan     0.1000    0.0386
    10        1.0997             nan     0.1000    0.0294
    20        0.9249             nan     0.1000    0.0260
    40        0.7474             nan     0.1000    0.0093
    60        0.6560             nan     0.1000    0.0054
    80        0.5927             nan     0.1000    0.0038
   100        0.5478             nan     0.1000    0.0017
   120        0.5110             nan     0.1000    0.0016
   140        0.4784             nan     0.1000    0.0007
   150        0.4669             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1320
     2        1.5227             nan     0.1000    0.0843
     3        1.4668             nan     0.1000    0.0639
     4        1.4237             nan     0.1000    0.0498
     5        1.3901             nan     0.1000    0.0403
     6        1.3634             nan     0.1000    0.0403
     7        1.3373             nan     0.1000    0.0307
     8        1.3166             nan     0.1000    0.0269
     9        1.2995             nan     0.1000    0.0271
    10        1.2798             nan     0.1000    0.0254
    20        1.1678             nan     0.1000    0.0109
    40        1.0635             nan     0.1000    0.0050
    60        1.0043             nan     0.1000    0.0029
    80        0.9608             nan     0.1000    0.0022
   100        0.9250             nan     0.1000    0.0023
   120        0.8967             nan     0.1000    0.0014
   140        0.8735             nan     0.1000    0.0017
   150        0.8619             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1720
     2        1.4964             nan     0.1000    0.1221
     3        1.4185             nan     0.1000    0.0900
     4        1.3591             nan     0.1000    0.0722
     5        1.3126             nan     0.1000    0.0570
     6        1.2761             nan     0.1000    0.0498
     7        1.2441             nan     0.1000    0.0446
     8        1.2148             nan     0.1000    0.0360
     9        1.1904             nan     0.1000    0.0302
    10        1.1699             nan     0.1000    0.0262
    20        1.0330             nan     0.1000    0.0108
    40        0.8790             nan     0.1000    0.0114
    60        0.7812             nan     0.1000    0.0038
    80        0.7192             nan     0.1000    0.0030
   100        0.6674             nan     0.1000    0.0023
   120        0.6278             nan     0.1000    0.0031
   140        0.5962             nan     0.1000    0.0015
   150        0.5837             nan     0.1000    0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2063
     2        1.4767             nan     0.1000    0.1487
     3        1.3830             nan     0.1000    0.1061
     4        1.3149             nan     0.1000    0.0870
     5        1.2604             nan     0.1000    0.0670
     6        1.2175             nan     0.1000    0.0558
     7        1.1821             nan     0.1000    0.0460
     8        1.1519             nan     0.1000    0.0467
     9        1.1223             nan     0.1000    0.0368
    10        1.0976             nan     0.1000    0.0340
    20        0.9175             nan     0.1000    0.0201
    40        0.7527             nan     0.1000    0.0111
    60        0.6540             nan     0.1000    0.0065
    80        0.5906             nan     0.1000    0.0044
   100        0.5461             nan     0.1000    0.0016
   120        0.5088             nan     0.1000    0.0028
   140        0.4775             nan     0.1000    0.0021
   150        0.4633             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1333
     2        1.5220             nan     0.1000    0.0876
     3        1.4639             nan     0.1000    0.0637
     4        1.4215             nan     0.1000    0.0532
     5        1.3869             nan     0.1000    0.0471
     6        1.3566             nan     0.1000    0.0356
     7        1.3329             nan     0.1000    0.0327
     8        1.3119             nan     0.1000    0.0263
     9        1.2946             nan     0.1000    0.0241
    10        1.2795             nan     0.1000    0.0304
    20        1.1622             nan     0.1000    0.0104
    40        1.0567             nan     0.1000    0.0046
    60        0.9949             nan     0.1000    0.0036
    80        0.9505             nan     0.1000    0.0032
   100        0.9147             nan     0.1000    0.0018
   120        0.8850             nan     0.1000    0.0020
   140        0.8600             nan     0.1000    0.0010
   150        0.8491             nan     0.1000    0.0004

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1766
     2        1.4939             nan     0.1000    0.1180
     3        1.4180             nan     0.1000    0.0921
     4        1.3592             nan     0.1000    0.0739
     5        1.3106             nan     0.1000    0.0608
     6        1.2718             nan     0.1000    0.0507
     7        1.2384             nan     0.1000    0.0424
     8        1.2111             nan     0.1000    0.0378
     9        1.1864             nan     0.1000    0.0321
    10        1.1648             nan     0.1000    0.0271
    20        1.0270             nan     0.1000    0.0145
    40        0.8785             nan     0.1000    0.0093
    60        0.7741             nan     0.1000    0.0049
    80        0.7125             nan     0.1000    0.0040
   100        0.6599             nan     0.1000    0.0027
   120        0.6203             nan     0.1000    0.0018
   140        0.5885             nan     0.1000    0.0013
   150        0.5738             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2107
     2        1.4748             nan     0.1000    0.1500
     3        1.3808             nan     0.1000    0.1053
     4        1.3139             nan     0.1000    0.0865
     5        1.2590             nan     0.1000    0.0727
     6        1.2126             nan     0.1000    0.0541
     7        1.1782             nan     0.1000    0.0522
     8        1.1442             nan     0.1000    0.0484
     9        1.1100             nan     0.1000    0.0347
    10        1.0883             nan     0.1000    0.0406
    20        0.9066             nan     0.1000    0.0190
    40        0.7382             nan     0.1000    0.0083
    60        0.6425             nan     0.1000    0.0057
    80        0.5802             nan     0.1000    0.0040
   100        0.5344             nan     0.1000    0.0023
   120        0.4969             nan     0.1000    0.0012
   140        0.4671             nan     0.1000    0.0018
   150        0.4549             nan     0.1000    0.0015

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1286
     2        1.5231             nan     0.1000    0.0846
     3        1.4668             nan     0.1000    0.0625
     4        1.4253             nan     0.1000    0.0487
     5        1.3917             nan     0.1000    0.0393
     6        1.3659             nan     0.1000    0.0413
     7        1.3395             nan     0.1000    0.0332
     8        1.3188             nan     0.1000    0.0259
     9        1.3021             nan     0.1000    0.0235
    10        1.2846             nan     0.1000    0.0261
    20        1.1721             nan     0.1000    0.0110
    40        1.0672             nan     0.1000    0.0058
    60        1.0044             nan     0.1000    0.0046
    80        0.9612             nan     0.1000    0.0019
   100        0.9269             nan     0.1000    0.0030
   120        0.8968             nan     0.1000    0.0015
   140        0.8726             nan     0.1000    0.0008
   150        0.8614             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1731
     2        1.4959             nan     0.1000    0.1185
     3        1.4200             nan     0.1000    0.0884
     4        1.3625             nan     0.1000    0.0682
     5        1.3170             nan     0.1000    0.0613
     6        1.2782             nan     0.1000    0.0486
     7        1.2473             nan     0.1000    0.0429
     8        1.2192             nan     0.1000    0.0350
     9        1.1961             nan     0.1000    0.0298
    10        1.1757             nan     0.1000    0.0280
    20        1.0356             nan     0.1000    0.0164
    40        0.8816             nan     0.1000    0.0105
    60        0.7858             nan     0.1000    0.0058
    80        0.7191             nan     0.1000    0.0032
   100        0.6650             nan     0.1000    0.0022
   120        0.6245             nan     0.1000    0.0037
   140        0.5915             nan     0.1000    0.0014
   150        0.5761             nan     0.1000    0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2025
     2        1.4768             nan     0.1000    0.1453
     3        1.3847             nan     0.1000    0.1074
     4        1.3151             nan     0.1000    0.0846
     5        1.2620             nan     0.1000    0.0694
     6        1.2176             nan     0.1000    0.0620
     7        1.1782             nan     0.1000    0.0465
     8        1.1475             nan     0.1000    0.0438
     9        1.1187             nan     0.1000    0.0360
    10        1.0956             nan     0.1000    0.0382
    20        0.9173             nan     0.1000    0.0222
    40        0.7459             nan     0.1000    0.0107
    60        0.6511             nan     0.1000    0.0052
    80        0.5834             nan     0.1000    0.0044
   100        0.5342             nan     0.1000    0.0004
   120        0.4988             nan     0.1000    0.0015
   140        0.4684             nan     0.1000    0.0005
   150        0.4552             nan     0.1000    0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1281
     2        1.5237             nan     0.1000    0.0858
     3        1.4666             nan     0.1000    0.0637
     4        1.4240             nan     0.1000    0.0522
     5        1.3902             nan     0.1000    0.0464
     6        1.3599             nan     0.1000    0.0342
     7        1.3379             nan     0.1000    0.0358
     8        1.3156             nan     0.1000    0.0265
     9        1.2978             nan     0.1000    0.0246
    10        1.2817             nan     0.1000    0.0317
    20        1.1649             nan     0.1000    0.0101
    40        1.0572             nan     0.1000    0.0048
    60        0.9964             nan     0.1000    0.0042
    80        0.9504             nan     0.1000    0.0022
   100        0.9146             nan     0.1000    0.0039
   120        0.8849             nan     0.1000    0.0018
   140        0.8602             nan     0.1000    0.0012
   150        0.8495             nan     0.1000    0.0004

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1729
     2        1.4968             nan     0.1000    0.1157
     3        1.4206             nan     0.1000    0.0934
     4        1.3607             nan     0.1000    0.0749
     5        1.3127             nan     0.1000    0.0576
     6        1.2756             nan     0.1000    0.0497
     7        1.2436             nan     0.1000    0.0431
     8        1.2154             nan     0.1000    0.0389
     9        1.1905             nan     0.1000    0.0312
    10        1.1691             nan     0.1000    0.0309
    20        1.0263             nan     0.1000    0.0166
    40        0.8718             nan     0.1000    0.0054
    60        0.7760             nan     0.1000    0.0044
    80        0.7119             nan     0.1000    0.0057
   100        0.6615             nan     0.1000    0.0033
   120        0.6223             nan     0.1000    0.0027
   140        0.5883             nan     0.1000    0.0015
   150        0.5750             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2099
     2        1.4759             nan     0.1000    0.1406
     3        1.3866             nan     0.1000    0.1136
     4        1.3150             nan     0.1000    0.0894
     5        1.2581             nan     0.1000    0.0719
     6        1.2133             nan     0.1000    0.0517
     7        1.1793             nan     0.1000    0.0513
     8        1.1466             nan     0.1000    0.0481
     9        1.1127             nan     0.1000    0.0431
    10        1.0862             nan     0.1000    0.0376
    20        0.9106             nan     0.1000    0.0208
    40        0.7385             nan     0.1000    0.0085
    60        0.6446             nan     0.1000    0.0070
    80        0.5841             nan     0.1000    0.0030
   100        0.5386             nan     0.1000    0.0026
   120        0.4988             nan     0.1000    0.0016
   140        0.4698             nan     0.1000    0.0017
   150        0.4553             nan     0.1000    0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1281
     2        1.5232             nan     0.1000    0.0877
     3        1.4642             nan     0.1000    0.0626
     4        1.4214             nan     0.1000    0.0505
     5        1.3872             nan     0.1000    0.0416
     6        1.3600             nan     0.1000    0.0373
     7        1.3351             nan     0.1000    0.0313
     8        1.3138             nan     0.1000    0.0255
     9        1.2969             nan     0.1000    0.0240
    10        1.2811             nan     0.1000    0.0201
    20        1.1716             nan     0.1000    0.0110
    40        1.0663             nan     0.1000    0.0055
    60        1.0054             nan     0.1000    0.0041
    80        0.9628             nan     0.1000    0.0011
   100        0.9292             nan     0.1000    0.0015
   120        0.8986             nan     0.1000    0.0007
   140        0.8750             nan     0.1000    0.0008
   150        0.8641             nan     0.1000    0.0002

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1701
     2        1.4971             nan     0.1000    0.1144
     3        1.4233             nan     0.1000    0.0881
     4        1.3653             nan     0.1000    0.0706
     5        1.3204             nan     0.1000    0.0561
     6        1.2835             nan     0.1000    0.0509
     7        1.2503             nan     0.1000    0.0412
     8        1.2228             nan     0.1000    0.0409
     9        1.1965             nan     0.1000    0.0312
    10        1.1759             nan     0.1000    0.0250
    20        1.0393             nan     0.1000    0.0162
    40        0.8837             nan     0.1000    0.0069
    60        0.7961             nan     0.1000    0.0073
    80        0.7251             nan     0.1000    0.0031
   100        0.6757             nan     0.1000    0.0019
   120        0.6375             nan     0.1000    0.0016
   140        0.6038             nan     0.1000    0.0013
   150        0.5899             nan     0.1000    0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2021
     2        1.4787             nan     0.1000    0.1397
     3        1.3903             nan     0.1000    0.1025
     4        1.3240             nan     0.1000    0.0795
     5        1.2722             nan     0.1000    0.0645
     6        1.2311             nan     0.1000    0.0577
     7        1.1942             nan     0.1000    0.0586
     8        1.1547             nan     0.1000    0.0441
     9        1.1261             nan     0.1000    0.0407
    10        1.0977             nan     0.1000    0.0361
    20        0.9206             nan     0.1000    0.0181
    40        0.7507             nan     0.1000    0.0098
    60        0.6544             nan     0.1000    0.0047
    80        0.5898             nan     0.1000    0.0034
   100        0.5437             nan     0.1000    0.0023
   120        0.5081             nan     0.1000    0.0013
   140        0.4791             nan     0.1000    0.0015
   150        0.4668             nan     0.1000    0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1282
     2        1.5227             nan     0.1000    0.0856
     3        1.4668             nan     0.1000    0.0629
     4        1.4244             nan     0.1000    0.0509
     5        1.3903             nan     0.1000    0.0443
     6        1.3605             nan     0.1000    0.0347
     7        1.3376             nan     0.1000    0.0324
     8        1.3169             nan     0.1000    0.0233
     9        1.3011             nan     0.1000    0.0250
    10        1.2844             nan     0.1000    0.0214
    20        1.1725             nan     0.1000    0.0119
    40        1.0681             nan     0.1000    0.0046
    60        1.0072             nan     0.1000    0.0043
    80        0.9626             nan     0.1000    0.0015
   100        0.9283             nan     0.1000    0.0026
   120        0.9000             nan     0.1000    0.0011
   140        0.8746             nan     0.1000    0.0006
   150        0.8638             nan     0.1000    0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1677
     2        1.4971             nan     0.1000    0.1152
     3        1.4211             nan     0.1000    0.0864
     4        1.3651             nan     0.1000    0.0754
     5        1.3174             nan     0.1000    0.0582
     6        1.2792             nan     0.1000    0.0499
     7        1.2472             nan     0.1000    0.0402
     8        1.2204             nan     0.1000    0.0333
     9        1.1985             nan     0.1000    0.0337
    10        1.1768             nan     0.1000    0.0259
    20        1.0347             nan     0.1000    0.0159
    40        0.8850             nan     0.1000    0.0112
    60        0.7840             nan     0.1000    0.0064
    80        0.7222             nan     0.1000    0.0025
   100        0.6725             nan     0.1000    0.0023
   120        0.6309             nan     0.1000    0.0016
   140        0.6005             nan     0.1000    0.0026
   150        0.5860             nan     0.1000    0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2064
     2        1.4792             nan     0.1000    0.1481
     3        1.3867             nan     0.1000    0.1025
     4        1.3211             nan     0.1000    0.0835
     5        1.2689             nan     0.1000    0.0698
     6        1.2252             nan     0.1000    0.0549
     7        1.1909             nan     0.1000    0.0463
     8        1.1605             nan     0.1000    0.0512
     9        1.1248             nan     0.1000    0.0469
    10        1.0939             nan     0.1000    0.0313
    20        0.9205             nan     0.1000    0.0183
    40        0.7503             nan     0.1000    0.0126
    60        0.6540             nan     0.1000    0.0048
    80        0.5895             nan     0.1000    0.0029
   100        0.5444             nan     0.1000    0.0021
   120        0.5054             nan     0.1000    0.0019
   140        0.4753             nan     0.1000    0.0010
   150        0.4627             nan     0.1000    0.0006

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1287
     2        1.5228             nan     0.1000    0.0843
     3        1.4663             nan     0.1000    0.0647
     4        1.4241             nan     0.1000    0.0488
     5        1.3920             nan     0.1000    0.0414
     6        1.3652             nan     0.1000    0.0394
     7        1.3397             nan     0.1000    0.0317
     8        1.3189             nan     0.1000    0.0249
     9        1.3022             nan     0.1000    0.0230
    10        1.2871             nan     0.1000    0.0258
    20        1.1773             nan     0.1000    0.0085
    40        1.0753             nan     0.1000    0.0054
    60        1.0121             nan     0.1000    0.0036
    80        0.9691             nan     0.1000    0.0039
   100        0.9322             nan     0.1000    0.0017
   120        0.9020             nan     0.1000    0.0015
   140        0.8779             nan     0.1000    0.0015
   150        0.8665             nan     0.1000    0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1700
     2        1.4983             nan     0.1000    0.1204
     3        1.4213             nan     0.1000    0.0870
     4        1.3653             nan     0.1000    0.0707
     5        1.3203             nan     0.1000    0.0573
     6        1.2841             nan     0.1000    0.0478
     7        1.2533             nan     0.1000    0.0412
     8        1.2261             nan     0.1000    0.0371
     9        1.2025             nan     0.1000    0.0338
    10        1.1796             nan     0.1000    0.0252
    20        1.0409             nan     0.1000    0.0149
    40        0.8867             nan     0.1000    0.0061
    60        0.7878             nan     0.1000    0.0060
    80        0.7257             nan     0.1000    0.0032
   100        0.6762             nan     0.1000    0.0032
   120        0.6364             nan     0.1000    0.0029
   140        0.6042             nan     0.1000    0.0017
   150        0.5891             nan     0.1000    0.0016

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2080
     2        1.4774             nan     0.1000    0.1373
     3        1.3886             nan     0.1000    0.1052
     4        1.3229             nan     0.1000    0.0829
     5        1.2698             nan     0.1000    0.0687
     6        1.2263             nan     0.1000    0.0555
     7        1.1913             nan     0.1000    0.0566
     8        1.1520             nan     0.1000    0.0399
     9        1.1258             nan     0.1000    0.0416
    10        1.1004             nan     0.1000    0.0399
    20        0.9214             nan     0.1000    0.0183
    40        0.7512             nan     0.1000    0.0089
    60        0.6584             nan     0.1000    0.0052
    80        0.5952             nan     0.1000    0.0036
   100        0.5478             nan     0.1000    0.0014
   120        0.5096             nan     0.1000    0.0012
   140        0.4799             nan     0.1000    0.0009
   150        0.4677             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1350
     2        1.5186             nan     0.1000    0.0893
     3        1.4588             nan     0.1000    0.0675
     4        1.4132             nan     0.1000    0.0529
     5        1.3782             nan     0.1000    0.0428
     6        1.3493             nan     0.1000    0.0428
     7        1.3224             nan     0.1000    0.0354
     8        1.2995             nan     0.1000    0.0256
     9        1.2827             nan     0.1000    0.0257
    10        1.2664             nan     0.1000    0.0246
    20        1.1533             nan     0.1000    0.0112
    40        1.0502             nan     0.1000    0.0047
    60        0.9880             nan     0.1000    0.0042
    80        0.9448             nan     0.1000    0.0025
   100        0.9113             nan     0.1000    0.0011
   120        0.8843             nan     0.1000    0.0010
   140        0.8597             nan     0.1000    0.0009
   150        0.8492             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1784
     2        1.4918             nan     0.1000    0.1214
     3        1.4117             nan     0.1000    0.0917
     4        1.3519             nan     0.1000    0.0759
     5        1.3041             nan     0.1000    0.0603
     6        1.2648             nan     0.1000    0.0507
     7        1.2322             nan     0.1000    0.0414
     8        1.2050             nan     0.1000    0.0367
     9        1.1810             nan     0.1000    0.0322
    10        1.1595             nan     0.1000    0.0258
    20        1.0219             nan     0.1000    0.0135
    40        0.8644             nan     0.1000    0.0079
    60        0.7761             nan     0.1000    0.0062
    80        0.7114             nan     0.1000    0.0036
   100        0.6607             nan     0.1000    0.0024
   120        0.6221             nan     0.1000    0.0016
   140        0.5895             nan     0.1000    0.0013
   150        0.5761             nan     0.1000    0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2139
     2        1.4716             nan     0.1000    0.1509
     3        1.3767             nan     0.1000    0.1092
     4        1.3088             nan     0.1000    0.0831
     5        1.2554             nan     0.1000    0.0733
     6        1.2066             nan     0.1000    0.0608
     7        1.1677             nan     0.1000    0.0477
     8        1.1365             nan     0.1000    0.0461
     9        1.1073             nan     0.1000    0.0402
    10        1.0798             nan     0.1000    0.0378
    20        0.9020             nan     0.1000    0.0181
    40        0.7287             nan     0.1000    0.0079
    60        0.6417             nan     0.1000    0.0047
    80        0.5794             nan     0.1000    0.0037
   100        0.5346             nan     0.1000    0.0019
   120        0.4982             nan     0.1000    0.0019
   140        0.4681             nan     0.1000    0.0010
   150        0.4557             nan     0.1000    0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1328
     2        1.5208             nan     0.1000    0.0854
     3        1.4632             nan     0.1000    0.0652
     4        1.4194             nan     0.1000    0.0518
     5        1.3858             nan     0.1000    0.0477
     6        1.3541             nan     0.1000    0.0350
     7        1.3305             nan     0.1000    0.0333
     8        1.3088             nan     0.1000    0.0290
     9        1.2892             nan     0.1000    0.0235
    10        1.2741             nan     0.1000    0.0219
    20        1.1613             nan     0.1000    0.0100
    40        1.0605             nan     0.1000    0.0067
    60        0.9953             nan     0.1000    0.0043
    80        0.9497             nan     0.1000    0.0024
   100        0.9150             nan     0.1000    0.0016
   120        0.8869             nan     0.1000    0.0016
   140        0.8622             nan     0.1000    0.0009
   150        0.8508             nan     0.1000    0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1755
     2        1.4944             nan     0.1000    0.1207
     3        1.4151             nan     0.1000    0.0885
     4        1.3570             nan     0.1000    0.0765
     5        1.3081             nan     0.1000    0.0550
     6        1.2711             nan     0.1000    0.0512
     7        1.2381             nan     0.1000    0.0414
     8        1.2110             nan     0.1000    0.0359
     9        1.1870             nan     0.1000    0.0291
    10        1.1670             nan     0.1000    0.0262
    20        1.0273             nan     0.1000    0.0147
    40        0.8680             nan     0.1000    0.0078
    60        0.7743             nan     0.1000    0.0049
    80        0.7085             nan     0.1000    0.0046
   100        0.6572             nan     0.1000    0.0030
   120        0.6174             nan     0.1000    0.0023
   140        0.5845             nan     0.1000    0.0029
   150        0.5703             nan     0.1000    0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2138
     2        1.4718             nan     0.1000    0.1408
     3        1.3810             nan     0.1000    0.1070
     4        1.3126             nan     0.1000    0.0824
     5        1.2593             nan     0.1000    0.0686
     6        1.2154             nan     0.1000    0.0602
     7        1.1771             nan     0.1000    0.0508
     8        1.1440             nan     0.1000    0.0406
     9        1.1172             nan     0.1000    0.0375
    10        1.0934             nan     0.1000    0.0418
    20        0.9118             nan     0.1000    0.0185
    40        0.7359             nan     0.1000    0.0080
    60        0.6415             nan     0.1000    0.0071
    80        0.5798             nan     0.1000    0.0052
   100        0.5310             nan     0.1000    0.0022
   120        0.4952             nan     0.1000    0.0015
   140        0.4668             nan     0.1000    0.0013
   150        0.4543             nan     0.1000    0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1328
     2        1.5202             nan     0.1000    0.0873
     3        1.4610             nan     0.1000    0.0666
     4        1.4166             nan     0.1000    0.0526
     5        1.3820             nan     0.1000    0.0437
     6        1.3543             nan     0.1000    0.0429
     7        1.3268             nan     0.1000    0.0338
     8        1.3053             nan     0.1000    0.0264
     9        1.2877             nan     0.1000    0.0262
    10        1.2708             nan     0.1000    0.0280
    20        1.1524             nan     0.1000    0.0108
    40        1.0495             nan     0.1000    0.0065
    60        0.9869             nan     0.1000    0.0032
    80        0.9436             nan     0.1000    0.0019
   100        0.9090             nan     0.1000    0.0015
   120        0.8790             nan     0.1000    0.0009
   140        0.8550             nan     0.1000    0.0010
   150        0.8446             nan     0.1000    0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1779
     2        1.4932             nan     0.1000    0.1250
     3        1.4137             nan     0.1000    0.0921
     4        1.3541             nan     0.1000    0.0752
     5        1.3056             nan     0.1000    0.0600
     6        1.2663             nan     0.1000    0.0523
     7        1.2334             nan     0.1000    0.0421
     8        1.2058             nan     0.1000    0.0363
     9        1.1812             nan     0.1000    0.0314
    10        1.1600             nan     0.1000    0.0313
    20        1.0161             nan     0.1000    0.0126
    40        0.8729             nan     0.1000    0.0090
    60        0.7709             nan     0.1000    0.0051
    80        0.7063             nan     0.1000    0.0042
   100        0.6577             nan     0.1000    0.0036
   120        0.6180             nan     0.1000    0.0031
   140        0.5824             nan     0.1000    0.0025
   150        0.5680             nan     0.1000    0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2110
     2        1.4729             nan     0.1000    0.1537
     3        1.3777             nan     0.1000    0.1128
     4        1.3071             nan     0.1000    0.0851
     5        1.2531             nan     0.1000    0.0704
     6        1.2090             nan     0.1000    0.0611
     7        1.1707             nan     0.1000    0.0476
     8        1.1395             nan     0.1000    0.0373
     9        1.1151             nan     0.1000    0.0414
    10        1.0888             nan     0.1000    0.0406
    20        0.9055             nan     0.1000    0.0204
    40        0.7348             nan     0.1000    0.0106
    60        0.6407             nan     0.1000    0.0075
    80        0.5779             nan     0.1000    0.0027
   100        0.5323             nan     0.1000    0.0014
   120        0.4970             nan     0.1000    0.0016
   140        0.4672             nan     0.1000    0.0008
   150        0.4552             nan     0.1000    0.0015

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1280
     2        1.5222             nan     0.1000    0.0870
     3        1.4644             nan     0.1000    0.0640
     4        1.4217             nan     0.1000    0.0483
     5        1.3893             nan     0.1000    0.0433
     6        1.3613             nan     0.1000    0.0408
     7        1.3351             nan     0.1000    0.0326
     8        1.3141             nan     0.1000    0.0250
     9        1.2970             nan     0.1000    0.0252
    10        1.2805             nan     0.1000    0.0256
    20        1.1677             nan     0.1000    0.0128
    40        1.0619             nan     0.1000    0.0064
    60        1.0006             nan     0.1000    0.0035
    80        0.9559             nan     0.1000    0.0022
   100        0.9202             nan     0.1000    0.0016
   120        0.8915             nan     0.1000    0.0018
   140        0.8661             nan     0.1000    0.0013
   150        0.8555             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1722
     2        1.4951             nan     0.1000    0.1197
     3        1.4183             nan     0.1000    0.0920
     4        1.3590             nan     0.1000    0.0715
     5        1.3125             nan     0.1000    0.0573
     6        1.2743             nan     0.1000    0.0498
     7        1.2411             nan     0.1000    0.0405
     8        1.2134             nan     0.1000    0.0358
     9        1.1895             nan     0.1000    0.0306
    10        1.1698             nan     0.1000    0.0332
    20        1.0343             nan     0.1000    0.0151
    40        0.8793             nan     0.1000    0.0088
    60        0.7809             nan     0.1000    0.0067
    80        0.7161             nan     0.1000    0.0034
   100        0.6609             nan     0.1000    0.0036
   120        0.6200             nan     0.1000    0.0014
   140        0.5883             nan     0.1000    0.0014
   150        0.5743             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2171
     2        1.4708             nan     0.1000    0.1380
     3        1.3808             nan     0.1000    0.1066
     4        1.3132             nan     0.1000    0.0821
     5        1.2605             nan     0.1000    0.0754
     6        1.2102             nan     0.1000    0.0588
     7        1.1722             nan     0.1000    0.0502
     8        1.1405             nan     0.1000    0.0442
     9        1.1110             nan     0.1000    0.0382
    10        1.0854             nan     0.1000    0.0326
    20        0.9170             nan     0.1000    0.0211
    40        0.7387             nan     0.1000    0.0073
    60        0.6449             nan     0.1000    0.0067
    80        0.5800             nan     0.1000    0.0033
   100        0.5334             nan     0.1000    0.0029
   120        0.4948             nan     0.1000    0.0026
   140        0.4642             nan     0.1000    0.0022
   150        0.4484             nan     0.1000    0.0023

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1298
     2        1.5240             nan     0.1000    0.0863
     3        1.4658             nan     0.1000    0.0647
     4        1.4233             nan     0.1000    0.0486
     5        1.3904             nan     0.1000    0.0449
     6        1.3603             nan     0.1000    0.0353
     7        1.3377             nan     0.1000    0.0314
     8        1.3162             nan     0.1000    0.0297
     9        1.2967             nan     0.1000    0.0208
    10        1.2828             nan     0.1000    0.0208
    20        1.1706             nan     0.1000    0.0093
    40        1.0677             nan     0.1000    0.0061
    60        1.0048             nan     0.1000    0.0039
    80        0.9619             nan     0.1000    0.0022
   100        0.9261             nan     0.1000    0.0025
   120        0.8965             nan     0.1000    0.0011
   140        0.8722             nan     0.1000    0.0015
   150        0.8607             nan     0.1000    0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1698
     2        1.4980             nan     0.1000    0.1202
     3        1.4200             nan     0.1000    0.0899
     4        1.3618             nan     0.1000    0.0713
     5        1.3159             nan     0.1000    0.0566
     6        1.2791             nan     0.1000    0.0498
     7        1.2469             nan     0.1000    0.0404
     8        1.2208             nan     0.1000    0.0335
     9        1.1982             nan     0.1000    0.0303
    10        1.1777             nan     0.1000    0.0358
    20        1.0406             nan     0.1000    0.0153
    40        0.8825             nan     0.1000    0.0112
    60        0.7838             nan     0.1000    0.0046
    80        0.7169             nan     0.1000    0.0042
   100        0.6652             nan     0.1000    0.0034
   120        0.6248             nan     0.1000    0.0016
   140        0.5923             nan     0.1000    0.0024
   150        0.5790             nan     0.1000    0.0026

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2034
     2        1.4766             nan     0.1000    0.1460
     3        1.3840             nan     0.1000    0.1030
     4        1.3172             nan     0.1000    0.0864
     5        1.2627             nan     0.1000    0.0698
     6        1.2177             nan     0.1000    0.0609
     7        1.1759             nan     0.1000    0.0516
     8        1.1431             nan     0.1000    0.0407
     9        1.1170             nan     0.1000    0.0373
    10        1.0910             nan     0.1000    0.0322
    20        0.9130             nan     0.1000    0.0161
    40        0.7435             nan     0.1000    0.0080
    60        0.6531             nan     0.1000    0.0071
    80        0.5880             nan     0.1000    0.0035
   100        0.5423             nan     0.1000    0.0025
   120        0.5054             nan     0.1000    0.0012
   140        0.4763             nan     0.1000    0.0022
   150        0.4626             nan     0.1000    0.0021

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1266
     2        1.5240             nan     0.1000    0.0830
     3        1.4687             nan     0.1000    0.0618
     4        1.4269             nan     0.1000    0.0502
     5        1.3932             nan     0.1000    0.0443
     6        1.3643             nan     0.1000    0.0334
     7        1.3415             nan     0.1000    0.0320
     8        1.3207             nan     0.1000    0.0249
     9        1.3045             nan     0.1000    0.0261
    10        1.2856             nan     0.1000    0.0246
    20        1.1751             nan     0.1000    0.0113
    40        1.0700             nan     0.1000    0.0045
    60        1.0079             nan     0.1000    0.0032
    80        0.9627             nan     0.1000    0.0021
   100        0.9292             nan     0.1000    0.0013
   120        0.9005             nan     0.1000    0.0022
   140        0.8771             nan     0.1000    0.0022
   150        0.8651             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1654
     2        1.4990             nan     0.1000    0.1142
     3        1.4238             nan     0.1000    0.0933
     4        1.3639             nan     0.1000    0.0704
     5        1.3179             nan     0.1000    0.0557
     6        1.2810             nan     0.1000    0.0483
     7        1.2489             nan     0.1000    0.0416
     8        1.2219             nan     0.1000    0.0323
     9        1.1999             nan     0.1000    0.0347
    10        1.1777             nan     0.1000    0.0324
    20        1.0399             nan     0.1000    0.0173
    40        0.8829             nan     0.1000    0.0067
    60        0.7879             nan     0.1000    0.0052
    80        0.7261             nan     0.1000    0.0055
   100        0.6732             nan     0.1000    0.0013
   120        0.6337             nan     0.1000    0.0026
   140        0.5995             nan     0.1000    0.0015
   150        0.5874             nan     0.1000    0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2025
     2        1.4786             nan     0.1000    0.1356
     3        1.3910             nan     0.1000    0.1089
     4        1.3221             nan     0.1000    0.0886
     5        1.2658             nan     0.1000    0.0687
     6        1.2211             nan     0.1000    0.0582
     7        1.1834             nan     0.1000    0.0537
     8        1.1467             nan     0.1000    0.0433
     9        1.1187             nan     0.1000    0.0361
    10        1.0959             nan     0.1000    0.0338
    20        0.9167             nan     0.1000    0.0185
    40        0.7484             nan     0.1000    0.0085
    60        0.6548             nan     0.1000    0.0055
    80        0.5921             nan     0.1000    0.0035
   100        0.5456             nan     0.1000    0.0023
   120        0.5091             nan     0.1000    0.0019
   140        0.4781             nan     0.1000    0.0015
   150        0.4635             nan     0.1000    0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1294
     2        1.5235             nan     0.1000    0.0865
     3        1.4660             nan     0.1000    0.0631
     4        1.4237             nan     0.1000    0.0508
     5        1.3898             nan     0.1000    0.0412
     6        1.3632             nan     0.1000    0.0393
     7        1.3376             nan     0.1000    0.0280
     8        1.3192             nan     0.1000    0.0298
     9        1.3000             nan     0.1000    0.0260
    10        1.2814             nan     0.1000    0.0241
    20        1.1696             nan     0.1000    0.0093
    40        1.0677             nan     0.1000    0.0047
    60        1.0036             nan     0.1000    0.0029
    80        0.9604             nan     0.1000    0.0027
   100        0.9243             nan     0.1000    0.0025
   120        0.8944             nan     0.1000    0.0013
   140        0.8693             nan     0.1000    0.0017
   150        0.8584             nan     0.1000    0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1737
     2        1.4973             nan     0.1000    0.1173
     3        1.4206             nan     0.1000    0.0914
     4        1.3609             nan     0.1000    0.0727
     5        1.3136             nan     0.1000    0.0569
     6        1.2756             nan     0.1000    0.0479
     7        1.2447             nan     0.1000    0.0421
     8        1.2170             nan     0.1000    0.0353
     9        1.1942             nan     0.1000    0.0310
    10        1.1736             nan     0.1000    0.0265
    20        1.0388             nan     0.1000    0.0145
    40        0.8877             nan     0.1000    0.0098
    60        0.7897             nan     0.1000    0.0053
    80        0.7258             nan     0.1000    0.0029
   100        0.6739             nan     0.1000    0.0023
   120        0.6331             nan     0.1000    0.0018
   140        0.5979             nan     0.1000    0.0015
   150        0.5844             nan     0.1000    0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2089
     2        1.4761             nan     0.1000    0.1397
     3        1.3867             nan     0.1000    0.1064
     4        1.3199             nan     0.1000    0.0838
     5        1.2666             nan     0.1000    0.0710
     6        1.2226             nan     0.1000    0.0610
     7        1.1847             nan     0.1000    0.0484
     8        1.1529             nan     0.1000    0.0445
     9        1.1252             nan     0.1000    0.0432
    10        1.0944             nan     0.1000    0.0336
    20        0.9254             nan     0.1000    0.0166
    40        0.7530             nan     0.1000    0.0118
    60        0.6543             nan     0.1000    0.0052
    80        0.5907             nan     0.1000    0.0033
   100        0.5448             nan     0.1000    0.0022
   120        0.5077             nan     0.1000    0.0031
   140        0.4757             nan     0.1000    0.0013
   150        0.4631             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1240
     2        1.5251             nan     0.1000    0.0837
     3        1.4688             nan     0.1000    0.0633
     4        1.4269             nan     0.1000    0.0489
     5        1.3938             nan     0.1000    0.0399
     6        1.3670             nan     0.1000    0.0398
     7        1.3413             nan     0.1000    0.0340
     8        1.3192             nan     0.1000    0.0253
     9        1.3024             nan     0.1000    0.0265
    10        1.2854             nan     0.1000    0.0248
    20        1.1749             nan     0.1000    0.0102
    40        1.0701             nan     0.1000    0.0052
    60        1.0088             nan     0.1000    0.0035
    80        0.9658             nan     0.1000    0.0026
   100        0.9304             nan     0.1000    0.0010
   120        0.9013             nan     0.1000    0.0020
   140        0.8769             nan     0.1000    0.0011
   150        0.8650             nan     0.1000    0.0007

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1683
     2        1.4984             nan     0.1000    0.1163
     3        1.4230             nan     0.1000    0.0881
     4        1.3659             nan     0.1000    0.0696
     5        1.3212             nan     0.1000    0.0577
     6        1.2836             nan     0.1000    0.0514
     7        1.2500             nan     0.1000    0.0417
     8        1.2231             nan     0.1000    0.0361
     9        1.1995             nan     0.1000    0.0321
    10        1.1786             nan     0.1000    0.0293
    20        1.0381             nan     0.1000    0.0175
    40        0.8855             nan     0.1000    0.0080
    60        0.7909             nan     0.1000    0.0039
    80        0.7269             nan     0.1000    0.0043
   100        0.6748             nan     0.1000    0.0021
   120        0.6351             nan     0.1000    0.0023
   140        0.6018             nan     0.1000    0.0021
   150        0.5872             nan     0.1000    0.0022

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1999
     2        1.4796             nan     0.1000    0.1340
     3        1.3917             nan     0.1000    0.1106
     4        1.3226             nan     0.1000    0.0851
     5        1.2679             nan     0.1000    0.0653
     6        1.2259             nan     0.1000    0.0623
     7        1.1868             nan     0.1000    0.0496
     8        1.1559             nan     0.1000    0.0488
     9        1.1216             nan     0.1000    0.0397
    10        1.0963             nan     0.1000    0.0320
    20        0.9231             nan     0.1000    0.0188
    40        0.7485             nan     0.1000    0.0087
    60        0.6594             nan     0.1000    0.0039
    80        0.5914             nan     0.1000    0.0036
   100        0.5455             nan     0.1000    0.0020
   120        0.5090             nan     0.1000    0.0017
   140        0.4809             nan     0.1000    0.0019
   150        0.4674             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1300
     2        1.5234             nan     0.1000    0.0872
     3        1.4669             nan     0.1000    0.0615
     4        1.4265             nan     0.1000    0.0505
     5        1.3930             nan     0.1000    0.0406
     6        1.3658             nan     0.1000    0.0321
     7        1.3444             nan     0.1000    0.0353
     8        1.3226             nan     0.1000    0.0278
     9        1.3048             nan     0.1000    0.0298
    10        1.2836             nan     0.1000    0.0188
    20        1.1721             nan     0.1000    0.0098
    40        1.0682             nan     0.1000    0.0063
    60        1.0051             nan     0.1000    0.0034
    80        0.9599             nan     0.1000    0.0019
   100        0.9257             nan     0.1000    0.0026
   120        0.8965             nan     0.1000    0.0018
   140        0.8721             nan     0.1000    0.0015
   150        0.8611             nan     0.1000    0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1727
     2        1.4958             nan     0.1000    0.1161
     3        1.4212             nan     0.1000    0.0882
     4        1.3644             nan     0.1000    0.0699
     5        1.3193             nan     0.1000    0.0592
     6        1.2810             nan     0.1000    0.0499
     7        1.2499             nan     0.1000    0.0446
     8        1.2213             nan     0.1000    0.0371
     9        1.1967             nan     0.1000    0.0300
    10        1.1771             nan     0.1000    0.0281
    20        1.0410             nan     0.1000    0.0137
    40        0.8840             nan     0.1000    0.0123
    60        0.7831             nan     0.1000    0.0046
    80        0.7203             nan     0.1000    0.0037
   100        0.6695             nan     0.1000    0.0017
   120        0.6348             nan     0.1000    0.0032
   140        0.6005             nan     0.1000    0.0016
   150        0.5849             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2046
     2        1.4788             nan     0.1000    0.1366
     3        1.3918             nan     0.1000    0.1059
     4        1.3235             nan     0.1000    0.0883
     5        1.2683             nan     0.1000    0.0693
     6        1.2240             nan     0.1000    0.0588
     7        1.1868             nan     0.1000    0.0496
     8        1.1513             nan     0.1000    0.0423
     9        1.1237             nan     0.1000    0.0422
    10        1.0977             nan     0.1000    0.0320
    20        0.9273             nan     0.1000    0.0177
    40        0.7461             nan     0.1000    0.0095
    60        0.6498             nan     0.1000    0.0043
    80        0.5882             nan     0.1000    0.0030
   100        0.5420             nan     0.1000    0.0021
   120        0.5055             nan     0.1000    0.0014
   140        0.4746             nan     0.1000    0.0005
   150        0.4616             nan     0.1000    0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1289
     2        1.5233             nan     0.1000    0.0865
     3        1.4664             nan     0.1000    0.0639
     4        1.4241             nan     0.1000    0.0485
     5        1.3924             nan     0.1000    0.0406
     6        1.3651             nan     0.1000    0.0376
     7        1.3402             nan     0.1000    0.0289
     8        1.3211             nan     0.1000    0.0308
     9        1.3016             nan     0.1000    0.0292
    10        1.2823             nan     0.1000    0.0233
    20        1.1765             nan     0.1000    0.0128
    40        1.0715             nan     0.1000    0.0049
    60        1.0074             nan     0.1000    0.0023
    80        0.9633             nan     0.1000    0.0025
   100        0.9284             nan     0.1000    0.0011
   120        0.8985             nan     0.1000    0.0010
   140        0.8731             nan     0.1000    0.0017
   150        0.8614             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1705
     2        1.4982             nan     0.1000    0.1169
     3        1.4225             nan     0.1000    0.0879
     4        1.3660             nan     0.1000    0.0743
     5        1.3187             nan     0.1000    0.0554
     6        1.2824             nan     0.1000    0.0489
     7        1.2508             nan     0.1000    0.0423
     8        1.2234             nan     0.1000    0.0339
     9        1.2010             nan     0.1000    0.0337
    10        1.1793             nan     0.1000    0.0252
    20        1.0453             nan     0.1000    0.0160
    40        0.8870             nan     0.1000    0.0078
    60        0.7928             nan     0.1000    0.0056
    80        0.7228             nan     0.1000    0.0040
   100        0.6738             nan     0.1000    0.0025
   120        0.6323             nan     0.1000    0.0012
   140        0.5987             nan     0.1000    0.0012
   150        0.5852             nan     0.1000    0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1937
     2        1.4832             nan     0.1000    0.1450
     3        1.3921             nan     0.1000    0.1098
     4        1.3220             nan     0.1000    0.0811
     5        1.2704             nan     0.1000    0.0770
     6        1.2187             nan     0.1000    0.0578
     7        1.1823             nan     0.1000    0.0568
     8        1.1464             nan     0.1000    0.0399
     9        1.1209             nan     0.1000    0.0404
    10        1.0925             nan     0.1000    0.0319
    20        0.9107             nan     0.1000    0.0180
    40        0.7534             nan     0.1000    0.0077
    60        0.6542             nan     0.1000    0.0046
    80        0.5906             nan     0.1000    0.0032
   100        0.5452             nan     0.1000    0.0031
   120        0.5070             nan     0.1000    0.0017
   140        0.4773             nan     0.1000    0.0010
   150        0.4636             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1320
     2        1.5218             nan     0.1000    0.0878
     3        1.4632             nan     0.1000    0.0649
     4        1.4198             nan     0.1000    0.0516
     5        1.3856             nan     0.1000    0.0468
     6        1.3557             nan     0.1000    0.0354
     7        1.3318             nan     0.1000    0.0329
     8        1.3101             nan     0.1000    0.0252
     9        1.2934             nan     0.1000    0.0249
    10        1.2768             nan     0.1000    0.0271
    20        1.1613             nan     0.1000    0.0116
    40        1.0569             nan     0.1000    0.0051
    60        0.9959             nan     0.1000    0.0040
    80        0.9547             nan     0.1000    0.0017
   100        0.9205             nan     0.1000    0.0018
   120        0.8921             nan     0.1000    0.0018
   140        0.8668             nan     0.1000    0.0009
   150        0.8564             nan     0.1000    0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1742
     2        1.4935             nan     0.1000    0.1155
     3        1.4160             nan     0.1000    0.0888
     4        1.3578             nan     0.1000    0.0735
     5        1.3101             nan     0.1000    0.0599
     6        1.2720             nan     0.1000    0.0456
     7        1.2419             nan     0.1000    0.0422
     8        1.2137             nan     0.1000    0.0386
     9        1.1882             nan     0.1000    0.0314
    10        1.1684             nan     0.1000    0.0257
    20        1.0233             nan     0.1000    0.0167
    40        0.8666             nan     0.1000    0.0071
    60        0.7769             nan     0.1000    0.0068
    80        0.7120             nan     0.1000    0.0038
   100        0.6648             nan     0.1000    0.0018
   120        0.6292             nan     0.1000    0.0006
   140        0.5969             nan     0.1000    0.0008
   150        0.5833             nan     0.1000    0.0015

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2159
     2        1.4715             nan     0.1000    0.1385
     3        1.3813             nan     0.1000    0.1068
     4        1.3120             nan     0.1000    0.0833
     5        1.2597             nan     0.1000    0.0659
     6        1.2172             nan     0.1000    0.0661
     7        1.1722             nan     0.1000    0.0488
     8        1.1408             nan     0.1000    0.0398
     9        1.1139             nan     0.1000    0.0409
    10        1.0871             nan     0.1000    0.0363
    20        0.9086             nan     0.1000    0.0223
    40        0.7424             nan     0.1000    0.0072
    60        0.6531             nan     0.1000    0.0051
    80        0.5904             nan     0.1000    0.0036
   100        0.5412             nan     0.1000    0.0021
   120        0.5049             nan     0.1000    0.0017
   140        0.4746             nan     0.1000    0.0008
   150        0.4609             nan     0.1000    0.0021

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1349
     2        1.5211             nan     0.1000    0.0888
     3        1.4620             nan     0.1000    0.0675
     4        1.4178             nan     0.1000    0.0507
     5        1.3835             nan     0.1000    0.0397
     6        1.3569             nan     0.1000    0.0410
     7        1.3303             nan     0.1000    0.0284
     8        1.3112             nan     0.1000    0.0272
     9        1.2931             nan     0.1000    0.0269
    10        1.2757             nan     0.1000    0.0255
    20        1.1635             nan     0.1000    0.0111
    40        1.0592             nan     0.1000    0.0041
    60        0.9968             nan     0.1000    0.0033
    80        0.9526             nan     0.1000    0.0035
   100        0.9177             nan     0.1000    0.0012
   120        0.8876             nan     0.1000    0.0016
   140        0.8628             nan     0.1000    0.0014
   150        0.8505             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1733
     2        1.4940             nan     0.1000    0.1195
     3        1.4156             nan     0.1000    0.0871
     4        1.3576             nan     0.1000    0.0716
     5        1.3111             nan     0.1000    0.0591
     6        1.2715             nan     0.1000    0.0520
     7        1.2385             nan     0.1000    0.0409
     8        1.2116             nan     0.1000    0.0373
     9        1.1874             nan     0.1000    0.0307
    10        1.1667             nan     0.1000    0.0287
    20        1.0287             nan     0.1000    0.0144
    40        0.8696             nan     0.1000    0.0067
    60        0.7743             nan     0.1000    0.0046
    80        0.7065             nan     0.1000    0.0048
   100        0.6565             nan     0.1000    0.0025
   120        0.6179             nan     0.1000    0.0025
   140        0.5844             nan     0.1000    0.0016
   150        0.5709             nan     0.1000    0.0008

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2160
     2        1.4708             nan     0.1000    0.1412
     3        1.3806             nan     0.1000    0.1096
     4        1.3113             nan     0.1000    0.0829
     5        1.2586             nan     0.1000    0.0691
     6        1.2145             nan     0.1000    0.0600
     7        1.1725             nan     0.1000    0.0474
     8        1.1426             nan     0.1000    0.0494
     9        1.1102             nan     0.1000    0.0367
    10        1.0866             nan     0.1000    0.0323
    20        0.9040             nan     0.1000    0.0133
    40        0.7390             nan     0.1000    0.0148
    60        0.6401             nan     0.1000    0.0048
    80        0.5761             nan     0.1000    0.0029
   100        0.5271             nan     0.1000    0.0015
   120        0.4897             nan     0.1000    0.0019
   140        0.4589             nan     0.1000    0.0009
   150        0.4456             nan     0.1000    0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1293
     2        1.5239             nan     0.1000    0.0869
     3        1.4668             nan     0.1000    0.0618
     4        1.4243             nan     0.1000    0.0495
     5        1.3917             nan     0.1000    0.0467
     6        1.3616             nan     0.1000    0.0334
     7        1.3397             nan     0.1000    0.0338
     8        1.3182             nan     0.1000    0.0270
     9        1.3002             nan     0.1000    0.0293
    10        1.2789             nan     0.1000    0.0234
    20        1.1663             nan     0.1000    0.0102
    40        1.0629             nan     0.1000    0.0052
    60        0.9996             nan     0.1000    0.0041
    80        0.9535             nan     0.1000    0.0020
   100        0.9189             nan     0.1000    0.0017
   120        0.8894             nan     0.1000    0.0020
   140        0.8647             nan     0.1000    0.0008
   150        0.8538             nan     0.1000    0.0011

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1708
     2        1.4978             nan     0.1000    0.1144
     3        1.4218             nan     0.1000    0.0929
     4        1.3620             nan     0.1000    0.0710
     5        1.3158             nan     0.1000    0.0608
     6        1.2770             nan     0.1000    0.0488
     7        1.2457             nan     0.1000    0.0404
     8        1.2191             nan     0.1000    0.0404
     9        1.1940             nan     0.1000    0.0305
    10        1.1739             nan     0.1000    0.0320
    20        1.0277             nan     0.1000    0.0148
    40        0.8720             nan     0.1000    0.0080
    60        0.7800             nan     0.1000    0.0057
    80        0.7114             nan     0.1000    0.0041
   100        0.6611             nan     0.1000    0.0020
   120        0.6253             nan     0.1000    0.0021
   140        0.5907             nan     0.1000    0.0021
   150        0.5759             nan     0.1000    0.0005

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2054
     2        1.4774             nan     0.1000    0.1361
     3        1.3892             nan     0.1000    0.1059
     4        1.3224             nan     0.1000    0.0881
     5        1.2663             nan     0.1000    0.0763
     6        1.2166             nan     0.1000    0.0601
     7        1.1792             nan     0.1000    0.0504
     8        1.1476             nan     0.1000    0.0428
     9        1.1205             nan     0.1000    0.0423
    10        1.0939             nan     0.1000    0.0388
    20        0.9076             nan     0.1000    0.0184
    40        0.7360             nan     0.1000    0.0103
    60        0.6433             nan     0.1000    0.0048
    80        0.5850             nan     0.1000    0.0039
   100        0.5392             nan     0.1000    0.0022
   120        0.5003             nan     0.1000    0.0028
   140        0.4696             nan     0.1000    0.0008
   150        0.4561             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1309
     2        1.5225             nan     0.1000    0.0865
     3        1.4659             nan     0.1000    0.0648
     4        1.4225             nan     0.1000    0.0517
     5        1.3882             nan     0.1000    0.0468
     6        1.3577             nan     0.1000    0.0335
     7        1.3353             nan     0.1000    0.0343
     8        1.3126             nan     0.1000    0.0252
     9        1.2963             nan     0.1000    0.0287
    10        1.2763             nan     0.1000    0.0238
    20        1.1646             nan     0.1000    0.0116
    40        1.0617             nan     0.1000    0.0067
    60        0.9979             nan     0.1000    0.0031
    80        0.9553             nan     0.1000    0.0018
   100        0.9204             nan     0.1000    0.0018
   120        0.8875             nan     0.1000    0.0010
   140        0.8621             nan     0.1000    0.0011
   150        0.8518             nan     0.1000    0.0022

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1770
     2        1.4950             nan     0.1000    0.1224
     3        1.4163             nan     0.1000    0.0875
     4        1.3586             nan     0.1000    0.0716
     5        1.3118             nan     0.1000    0.0606
     6        1.2725             nan     0.1000    0.0508
     7        1.2396             nan     0.1000    0.0409
     8        1.2135             nan     0.1000    0.0367
     9        1.1894             nan     0.1000    0.0316
    10        1.1684             nan     0.1000    0.0272
    20        1.0294             nan     0.1000    0.0110
    40        0.8691             nan     0.1000    0.0070
    60        0.7721             nan     0.1000    0.0055
    80        0.7050             nan     0.1000    0.0039
   100        0.6541             nan     0.1000    0.0020
   120        0.6145             nan     0.1000    0.0022
   140        0.5819             nan     0.1000    0.0007
   150        0.5670             nan     0.1000    0.0014

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2093
     2        1.4740             nan     0.1000    0.1408
     3        1.3840             nan     0.1000    0.1053
     4        1.3163             nan     0.1000    0.0879
     5        1.2597             nan     0.1000    0.0708
     6        1.2139             nan     0.1000    0.0640
     7        1.1738             nan     0.1000    0.0571
     8        1.1344             nan     0.1000    0.0429
     9        1.1067             nan     0.1000    0.0427
    10        1.0779             nan     0.1000    0.0299
    20        0.9057             nan     0.1000    0.0243
    40        0.7363             nan     0.1000    0.0123
    60        0.6378             nan     0.1000    0.0021
    80        0.5755             nan     0.1000    0.0049
   100        0.5269             nan     0.1000    0.0018
   120        0.4898             nan     0.1000    0.0017
   140        0.4603             nan     0.1000    0.0007
   150        0.4472             nan     0.1000    0.0019

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1267
     2        1.5249             nan     0.1000    0.0841
     3        1.4679             nan     0.1000    0.0625
     4        1.4254             nan     0.1000    0.0490
     5        1.3931             nan     0.1000    0.0469
     6        1.3625             nan     0.1000    0.0371
     7        1.3385             nan     0.1000    0.0335
     8        1.3174             nan     0.1000    0.0250
     9        1.3007             nan     0.1000    0.0246
    10        1.2844             nan     0.1000    0.0219
    20        1.1702             nan     0.1000    0.0132
    40        1.0664             nan     0.1000    0.0065
    60        1.0021             nan     0.1000    0.0028
    80        0.9583             nan     0.1000    0.0014
   100        0.9260             nan     0.1000    0.0027
   120        0.8969             nan     0.1000    0.0012
   140        0.8740             nan     0.1000    0.0013
   150        0.8638             nan     0.1000    0.0018

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1709
     2        1.4970             nan     0.1000    0.1204
     3        1.4187             nan     0.1000    0.0880
     4        1.3627             nan     0.1000    0.0746
     5        1.3145             nan     0.1000    0.0570
     6        1.2771             nan     0.1000    0.0518
     7        1.2436             nan     0.1000    0.0415
     8        1.2156             nan     0.1000    0.0364
     9        1.1917             nan     0.1000    0.0365
    10        1.1680             nan     0.1000    0.0307
    20        1.0349             nan     0.1000    0.0141
    40        0.8778             nan     0.1000    0.0088
    60        0.7854             nan     0.1000    0.0051
    80        0.7215             nan     0.1000    0.0035
   100        0.6727             nan     0.1000    0.0020
   120        0.6307             nan     0.1000    0.0025
   140        0.5986             nan     0.1000    0.0016
   150        0.5844             nan     0.1000    0.0020

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2130
     2        1.4733             nan     0.1000    0.1358
     3        1.3868             nan     0.1000    0.1092
     4        1.3177             nan     0.1000    0.0836
     5        1.2642             nan     0.1000    0.0698
     6        1.2185             nan     0.1000    0.0559
     7        1.1831             nan     0.1000    0.0476
     8        1.1524             nan     0.1000    0.0486
     9        1.1187             nan     0.1000    0.0358
    10        1.0956             nan     0.1000    0.0402
    20        0.9163             nan     0.1000    0.0149
    40        0.7466             nan     0.1000    0.0100
    60        0.6540             nan     0.1000    0.0040
    80        0.5943             nan     0.1000    0.0032
   100        0.5489             nan     0.1000    0.0034
   120        0.5107             nan     0.1000    0.0035
   140        0.4797             nan     0.1000    0.0009
   150        0.4662             nan     0.1000    0.0013

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1275
     2        1.5233             nan     0.1000    0.0858
     3        1.4653             nan     0.1000    0.0626
     4        1.4237             nan     0.1000    0.0496
     5        1.3908             nan     0.1000    0.0400
     6        1.3643             nan     0.1000    0.0390
     7        1.3396             nan     0.1000    0.0326
     8        1.3179             nan     0.1000    0.0251
     9        1.3010             nan     0.1000    0.0266
    10        1.2840             nan     0.1000    0.0248
    20        1.1725             nan     0.1000    0.0124
    40        1.0685             nan     0.1000    0.0044
    60        1.0071             nan     0.1000    0.0039
    80        0.9618             nan     0.1000    0.0027
   100        0.9262             nan     0.1000    0.0016
   120        0.8978             nan     0.1000    0.0011
   140        0.8733             nan     0.1000    0.0009
   150        0.8632             nan     0.1000    0.0009

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.1663
     2        1.4990             nan     0.1000    0.1195
     3        1.4216             nan     0.1000    0.0908
     4        1.3639             nan     0.1000    0.0699
     5        1.3187             nan     0.1000    0.0555
     6        1.2823             nan     0.1000    0.0490
     7        1.2507             nan     0.1000    0.0443
     8        1.2221             nan     0.1000    0.0379
     9        1.1977             nan     0.1000    0.0298
    10        1.1780             nan     0.1000    0.0276
    20        1.0397             nan     0.1000    0.0171
    40        0.8857             nan     0.1000    0.0066
    60        0.7944             nan     0.1000    0.0060
    80        0.7290             nan     0.1000    0.0032
   100        0.6776             nan     0.1000    0.0040
   120        0.6366             nan     0.1000    0.0028
   140        0.6030             nan     0.1000    0.0015
   150        0.5892             nan     0.1000    0.0010

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2011
     2        1.4802             nan     0.1000    0.1483
     3        1.3877             nan     0.1000    0.1025
     4        1.3226             nan     0.1000    0.0803
     5        1.2714             nan     0.1000    0.0735
     6        1.2245             nan     0.1000    0.0540
     7        1.1894             nan     0.1000    0.0592
     8        1.1503             nan     0.1000    0.0424
     9        1.1232             nan     0.1000    0.0394
    10        1.0978             nan     0.1000    0.0450
    20        0.9162             nan     0.1000    0.0164
    40        0.7499             nan     0.1000    0.0092
    60        0.6547             nan     0.1000    0.0041
    80        0.5892             nan     0.1000    0.0035
   100        0.5418             nan     0.1000    0.0024
   120        0.5027             nan     0.1000    0.0020
   140        0.4734             nan     0.1000    0.0013
   150        0.4600             nan     0.1000    0.0012

Iter   TrainDeviance   ValidDeviance   StepSize   Improve
     1        1.6094             nan     0.1000    0.2037
     2        1.4765             nan     0.1000    0.1449
     3        1.3854             nan     0.1000    0.1081
     4        1.3170             nan     0.1000    0.0843
     5        1.2622             nan     0.1000    0.0684
     6        1.2184             nan     0.1000    0.0601
     7        1.1765             nan     0.1000    0.0462
     8        1.1462             nan     0.1000    0.0445
     9        1.1179             nan     0.1000    0.0407
    10        1.0927             nan     0.1000    0.0375
    20        0.9171             nan     0.1000    0.0194
    40        0.7463             nan     0.1000    0.0088
    60        0.6553             nan     0.1000    0.0046
    80        0.5954             nan     0.1000    0.0033
   100        0.5498             nan     0.1000    0.0017
   120        0.5128             nan     0.1000    0.0021
   140        0.4853             nan     0.1000    0.0009
   150        0.4739             nan     0.1000    0.0007

pred4=predict(mod4, newdata=validation)
confusionMatrix(pred4, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1511   80   23   13    9
         B   38  800   65   42   55
         C   87  126  868   64   47
         D   32  114   60  817   29
         E    6   19   10   28  942

Overall Statistics
                                          
               Accuracy : 0.8391          
                 95% CI : (0.8294, 0.8484)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.7968          
 Mcnemar's Test P-Value : < 2.2e-16       

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9026   0.7024   0.8460   0.8475   0.8706
Specificity            0.9703   0.9579   0.9333   0.9522   0.9869
Pos Pred Value         0.9236   0.8000   0.7282   0.7766   0.9373
Neg Pred Value         0.9616   0.9306   0.9663   0.9696   0.9713
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
Detection Rate         0.2568   0.1359   0.1475   0.1388   0.1601
Detection Prevalence   0.2780   0.1699   0.2025   0.1788   0.1708
Balanced Accuracy      0.9365   0.8301   0.8897   0.8999   0.9287


preds=data.frame(pred3, pred4, classe=validation$classe)
mod5=train(classe~., data=preds, method="gam"

+ 
mod5=train(classe~., data=preds, method="gam")
Loading required package: mgcv
Loading required package: nlme
This is mgcv 1.8-12. For overview type 'help("mgcv-package")'.
pred5=predict(mod5, newdata=validation)
confusionMatrix(pred5, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1580   38    8    5    2
         B   94 1101 1018  959 1080
         C    0    0    0    0    0
         D    0    0    0    0    0
         E    0    0    0    0    0

Overall Statistics
                                          
               Accuracy : 0.4556          
                 95% CI : (0.4428, 0.4684)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.3031          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9438   0.9666   0.0000   0.0000   0.0000
Specificity            0.9874   0.3361   1.0000   1.0000   1.0000
Pos Pred Value         0.9675   0.2589      NaN      NaN      NaN
Neg Pred Value         0.9779   0.9767   0.8257   0.8362   0.8161
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
Detection Rate         0.2685   0.1871   0.0000   0.0000   0.0000
Detection Prevalence   0.2775   0.7225   0.0000   0.0000   0.0000
Balanced Accuracy      0.9656   0.6514   0.5000   0.5000   0.5000


mod6=train(classe~.-X-raw_timestamp_part_1-raw_timestamp_part_2-cvtd_timestamp, data=training, method="rf", trControl=trainControl(method="cv"), number=3)

mod7=train(classe~.-X-raw_timestamp_part_1-raw_timestamp_part_2-cvtd_timestamp, data=training, method="rpart", trControl=trainControl(method="cv", number=5))
prp(mod7$finalModel)
pred7=predict(mod7, newdata=validation)
confusionMatrix(pred7, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1507  462  464  425  171
         B   36  386   48  183  155
         C  128  291  514  356  288
         D    0    0    0    0    0
         E    3    0    0    0  468

Overall Statistics
                                          
               Accuracy : 0.4885          
                 95% CI : (0.4757, 0.5014)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.3319          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9002  0.33889  0.50097   0.0000  0.43253
Specificity            0.6386  0.91108  0.78123   1.0000  0.99938
Pos Pred Value         0.4975  0.47772  0.32594      NaN  0.99363
Neg Pred Value         0.9415  0.85168  0.88115   0.8362  0.88659
Prevalence             0.2845  0.19354  0.17434   0.1638  0.18386
Detection Rate         0.2561  0.06559  0.08734   0.0000  0.07952
Detection Prevalence   0.5147  0.13730  0.26797   0.0000  0.08003
Balanced Accuracy      0.7694  0.62499  0.64110   0.5000  0.71595

mod8=train(classe~.-X, data=training, method="rpart", trControl=trainControl(method="cv", number=5))
pred8=predict(mod8, newdata=validation)
confusionMatrix(pred8, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1091  115    0    0    0
         B  209  405  110  256   54
         C  371  619  916  708  560
         D    0    0    0    0    0
         E    3    0    0    0  468

Overall Statistics
                                          
               Accuracy : 0.4894          
                 95% CI : (0.4765, 0.5022)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.3609          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.6517  0.35558   0.8928   0.0000  0.43253
Specificity            0.9727  0.86747   0.5353   1.0000  0.99938
Pos Pred Value         0.9046  0.39168   0.2886      NaN  0.99363
Neg Pred Value         0.8754  0.84869   0.9594   0.8362  0.88659
Prevalence             0.2845  0.19354   0.1743   0.1638  0.18386
Detection Rate         0.1854  0.06882   0.1556   0.0000  0.07952
Detection Prevalence   0.2049  0.17570   0.5393   0.0000  0.08003
Balanced Accuracy      0.8122  0.61152   0.7140   0.5000  0.71595
prp(mod8$finalModel)

prp(mod7$finalModel)
prp(mod7$finalModel, varlen = 35)


mod7$finalModel
n= 13737 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 13737 9831 A (0.28 0.19 0.17 0.16 0.18)  
   2) roll_belt< 130.5 12563 8668 A (0.31 0.21 0.19 0.18 0.11)  
     4) pitch_forearm< -33.95 1110    6 A (0.99 0.0054 0 0 0) *
     5) pitch_forearm>=-33.95 11453 8662 A (0.24 0.23 0.21 0.2 0.12)  
      10) magnet_dumbbell_y< 426.5 9515 6811 A (0.28 0.18 0.24 0.19 0.1)  
        20) roll_forearm< 121.5 5871 3445 A (0.41 0.18 0.19 0.17 0.055) *
        21) roll_forearm>=121.5 3644 2431 C (0.076 0.18 0.33 0.23 0.18) *
      11) magnet_dumbbell_y>=426.5 1938  976 B (0.045 0.5 0.042 0.22 0.19) *
   3) roll_belt>=130.5 1174   11 E (0.0094 0 0 0 0.99) *


mod9=train(classe~roll_belt+pitch_forearm+magnet_dumbbell_y+roll_forearm, data=training, method="rf", ntree=200)
pred9=predict(mod9, newdata=validation)
confusionMatrix(pred9, validation$classe)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1582   41   11    5    1
         B   11  929   23   28   31
         C   53   92  944   40   17
         D   25   68   40  888    8
         E    3    9    8    3 1025

Overall Statistics
                                          
               Accuracy : 0.9121          
                 95% CI : (0.9046, 0.9193)
    No Information Rate : 0.2845          
    P-Value [Acc NIR] : < 2.2e-16       
                                          
                  Kappa : 0.889           
 Mcnemar's Test P-Value : < 2.2e-16       

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9450   0.8156   0.9201   0.9212   0.9473
Specificity            0.9862   0.9804   0.9584   0.9713   0.9952
Pos Pred Value         0.9646   0.9090   0.8237   0.8630   0.9781
Neg Pred Value         0.9783   0.9568   0.9827   0.9843   0.9882
Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
Detection Rate         0.2688   0.1579   0.1604   0.1509   0.1742
Detection Prevalence   0.2787   0.1737   0.1947   0.1749   0.1781
Balanced Accuracy      0.9656   0.8980   0.9393   0.9463   0.9713